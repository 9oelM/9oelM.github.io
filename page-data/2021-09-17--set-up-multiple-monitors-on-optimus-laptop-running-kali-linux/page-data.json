{"componentChunkName":"component---src-templates-blog-post-js","path":"/2021-09-17--set-up-multiple-monitors-on-optimus-laptop-running-kali-linux/","result":{"data":{"site":{"siteMetadata":{"title":"Joel's dev blog","author":"Joel Mun","siteUrl":"https://9oelm.github.io"}},"markdownRemark":{"id":"67c25251-c402-587d-86be-c6b299a0310f","excerpt":"I needed to figure out how to set up multiple monitors on my new Kali linux laptop, because it wouldn’t just work automatically like MacOS or Windows. At the…","html":"<p>I needed to figure out how to set up multiple monitors on my new Kali linux laptop, because it wouldn’t just work automatically like MacOS or Windows. At the end of a week-long research and accumulation of fragmented information on the Internet, I finally found a way to set it up. So here’s my guide.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#new-optimus-laptop\">New optimus laptop</a></li>\n<li><a href=\"#problem-kali-linux-wont-just-set-up-multiple-screens-for-you-if-you-are-using-an-optimus-laptop\">Problem: Kali linux won’t just set up multiple screens for you if you are using an Optimus laptop</a></li>\n<li><a href=\"#steps-to-the-success\">Steps to the success</a></li>\n</ul>\n</div>\n<h1 id=\"new-optimus-laptop\" style=\"position:relative;\">New optimus laptop<a href=\"#new-optimus-laptop\" aria-label=\"new optimus laptop permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f19890772aea3983bf0489e1f52b69e5/d2602/3.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAECBAX/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAAB57yWMgj/xAAYEAEAAwEAAAAAAAAAAAAAAAACAAEDEP/aAAgBAQABBQI6qXoomrvv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEyIDH/2gAIAQEABj8CplM7j//EABsQAAIBBQAAAAAAAAAAAAAAAAABIRAxQYGh/9oACAEBAAE/IUY7DGTZLKnc/9oADAMBAAIAAwAAABDgP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQEBAAIDAAAAAAAAAAAAAAERABAhQWFx/9oACAEBAAE/EDACe06xfqWulUJfLhj1heD/2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Razer RZ09-0369 lid\"\n        title=\"Razer RZ09-0369 lid\"\n        src=\"/static/f19890772aea3983bf0489e1f52b69e5/1c72d/3.jpg\"\n        srcset=\"/static/f19890772aea3983bf0489e1f52b69e5/a80bd/3.jpg 148w,\n/static/f19890772aea3983bf0489e1f52b69e5/1c91a/3.jpg 295w,\n/static/f19890772aea3983bf0489e1f52b69e5/1c72d/3.jpg 590w,\n/static/f19890772aea3983bf0489e1f52b69e5/a8a14/3.jpg 885w,\n/static/f19890772aea3983bf0489e1f52b69e5/fbd2c/3.jpg 1180w,\n/static/f19890772aea3983bf0489e1f52b69e5/d2602/3.jpg 4032w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0ac844cf18663cc499b3f9bfda0a42c2/d2602/5.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAgP/xAAVAQEBAAAAAAAAAAAAAAAAAAAAAf/aAAwDAQACEAMQAAABms89loUI/8QAGhAAAQUBAAAAAAAAAAAAAAAAAQACAxESM//aAAgBAQABBQK6JJzFxDQVSie7H//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAEDAQE/ASf/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAZEAACAwEAAAAAAAAAAAAAAAAAEAIhMXH/2gAIAQEABj8CUOFrcP/EABsQAQACAgMAAAAAAAAAAAAAAAEAEUFxITGh/9oACAEBAAE/IRg5lFi4E04wo9lOpxFqVGp//9oADAMBAAIAAwAAABBEP//EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQMBAT8Qhqn/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBZ/8QAGhABAAMBAQEAAAAAAAAAAAAAAQARIVExQf/aAAgBAQABPxASmM2OwULhA+3ReC2/UayjXFZyMPgCif/Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Razer RZ09-0369 screen\"\n        title=\"Razer RZ09-0369 screen\"\n        src=\"/static/0ac844cf18663cc499b3f9bfda0a42c2/1c72d/5.jpg\"\n        srcset=\"/static/0ac844cf18663cc499b3f9bfda0a42c2/a80bd/5.jpg 148w,\n/static/0ac844cf18663cc499b3f9bfda0a42c2/1c91a/5.jpg 295w,\n/static/0ac844cf18663cc499b3f9bfda0a42c2/1c72d/5.jpg 590w,\n/static/0ac844cf18663cc499b3f9bfda0a42c2/a8a14/5.jpg 885w,\n/static/0ac844cf18663cc499b3f9bfda0a42c2/fbd2c/5.jpg 1180w,\n/static/0ac844cf18663cc499b3f9bfda0a42c2/d2602/5.jpg 4032w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>So I’ve got my brand new laptop, which is <a href=\"https://mysupport.razer.com/app/answers/detail/a_id/4014/~/at-a-glance%3A-razer-blade-15-base-%282021%29-%7C-rz09-0369\">Razer RZ09-0369</a>. And guess what, I’m not running Windows on this beast for sure. I bought this to run Kali Linux. </p>\n<p>I already have my Macbook Pro which runs fairly well despite the two years of active usage, but when it comes to hacking and similar stuffs, I found that I’m not just vibing with it and sometimes it is quite tricky to do stuffs on it. Lots of people use Kali on virtual machine but there are obvious limitations, so I went for another physical machine.</p>\n<h1 id=\"problem-kali-linux-wont-just-set-up-multiple-screens-for-you-if-you-are-using-an-optimus-laptop\" style=\"position:relative;\">Problem: Kali linux won’t just set up multiple screens for you if you are using an Optimus laptop<a href=\"#problem-kali-linux-wont-just-set-up-multiple-screens-for-you-if-you-are-using-an-optimus-laptop\" aria-label=\"problem kali linux wont just set up multiple screens for you if you are using an optimus laptop permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<p>Last time when I was using my little old Samsung laptop without any Nvidia GPU (only Intel integrated graphics) to run some tests on Kali linux, I absolutely had no problems with connecting to a single external screen. <strong>But oh dear, now I’m on a machine that’s intended for gaming and it’s got a huge Nvidia GPU in it along with the Intel integrated graphics, and I’ve got two external monitors I want to connect to.</strong> And just in case you don’t know what an Optimus means: having an ‘Optimus’ laptop means you have both Nvidia GPU (dGPU) and iGPU in your machine, and your machine switches back and forth from one to another for different tasks (i.e. your laptop may switch to dGPU once you start up a game which requires a lot more graphic processing than normal). Anyways, in such a case, <em>it won’t just work without additional custom configurations if you are running Kali linux.</em></p>\n<p><strong>I searched all the way up to the very edge of the Internet, but seriously I couldn’t find a single answer that worked for me. <a href=\"https://www.kali.org/docs/general-use/install-nvidia-drivers-on-kali-linux/\">The official documentation on Kali linux</a> does not work because it is not for laptop but desktop users.</strong> In the end, I found that summing up all those answers appropriately after clearly understanding what needed to be done is the only way to get it working. Let me start off.</p>\n<h1 id=\"steps-to-the-success\" style=\"position:relative;\">Steps to the success<a href=\"#steps-to-the-success\" aria-label=\"steps to the success permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- Disclaimer #0: this might be a daunting process. Stay calm and keep going on even if you feel like you are lost in the middle.\n- Disclaimer #1: this has been tested on `5.10.0-kali9-amd64` (around July 2021).\n- FYI #0: I&#39;m using KDE.\n- FYI #1: I&#39;ve got two external monitors to connect to, both of which are connected via HDMI.</code></pre></div>\n<ol>\n<li>Update </li>\n</ol>\n<p>Before doing anything else, just make sure that your softare is up to date.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> dist-upgrade</code></pre></div>\n<p>Btw, you can plug your HDMI/DP/VGA cables into your machine in advance.</p>\n<ol start=\"2\">\n<li>Install kernal headers</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y linux-headers-<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> -r<span class=\"token variable\">)</span></span></code></pre></div>\n<p>The above command might not work because Kali recently changed postfixes of packages. If it can’t find the corresponding package, go to <a href=\"https://http.kali.org/kali/pool/main/l/linux/\">https://http.kali.org/kali/pool/main/l/linux/</a> and find packages named <code class=\"language-text\">linux-headers-$(uname -r)</code>.  For example, mine is </p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">└─$ <span class=\"token function\">uname</span> -r\n<span class=\"token number\">5.10</span>.0-kali9-amd64</code></pre></div>\n<p>So I’ve gotta look for <code class=\"language-text\">linux-header-5.10.0-kali7-amd64*</code> packages.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0d0ebd80582650ebcfea1182a8fe58fd/1c3a5/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABo0lEQVQoz1WRW1LjMBBFWYUfaokQiBVbbztkgPidGCapofhjAfzA/ndAS04KpkofKpWObt+jq3Z6BXNgdk9lw9wLw70ZqWqp3TN7oKpLgUZJuuLr++0fW1bG2lyIhJCEwFX/8gZ6ZGZPRY0wNYMndUcNHo5kXeGl37B1Li8u8G48guyY6iB/oPiEbD1cPGImVQ3THbnhURzfeXhry1IZ85O8G/8S2TIdABxYNn6JpzPsJnIrEF6uskDaQiqe50h6uB6PiWiJbKB4BD0AJvvVhBF6yLcpXeDYdxl3ZYWw1IavL3B/er8ZPpfjJ2s+ln7ztdicQOyY7im+xTc4IcK3qwxhobRUGuF4HruZXll1XFRH1HNdna7DZraNCph7Jst1lCQobHPvO6OwQsg4DXD3/Eb0GNrWzEyY5s3rwZN2onbCOlEKK86DMLRd5oU8J7eHf6B6tIrCGDLYVg3ghTXBWQu8jFISvmqrnTP291cN3jZ+LCZQ7Im3RY2dz2TxkCTx3LmsKrSljf3PNvFpDZ1hieQTyDrAHWQ2BTbDxjmEldbZxfY3X2ttqPbVCD0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Kali linux header\"\n        title=\"Kali linux header\"\n        src=\"/static/0d0ebd80582650ebcfea1182a8fe58fd/fcda8/6.png\"\n        srcset=\"/static/0d0ebd80582650ebcfea1182a8fe58fd/12f09/6.png 148w,\n/static/0d0ebd80582650ebcfea1182a8fe58fd/e4a3f/6.png 295w,\n/static/0d0ebd80582650ebcfea1182a8fe58fd/fcda8/6.png 590w,\n/static/0d0ebd80582650ebcfea1182a8fe58fd/efc66/6.png 885w,\n/static/0d0ebd80582650ebcfea1182a8fe58fd/1c3a5/6.png 981w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>There it is! Download it.</p>\n<p>Also, if you just look down below, there are <code class=\"language-text\">linux-header-5.10.0-kali7-common*</code> packages. <strong>Download the one without rt and install that first</strong>.</p>\n<p>The resulting command must be something like:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> dpkg -i linux-headers-5.10.0-kali7-common_5.10.28-1kali1_all.deb\n<span class=\"token function\">sudo</span> dpkg -i linux-headers-5.10.0-kali7-amd64_5.10.28-1kali1_amd64.deb</code></pre></div>\n<ol start=\"3\">\n<li>Install Nvidia drivers</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> nvidia-driver nvidia-xconfig</code></pre></div>\n<ol start=\"4\">\n<li>Edit blacklist to prevent <code class=\"language-text\">nouveau</code> from starting at next boot</li>\n</ol>\n<p><code class=\"language-text\">nouveau</code> is the default graphics driver but now that you installed <code class=\"language-text\">nvdia-driver</code>, we wanna make sure that you don’t use <code class=\"language-text\">nouveau</code> anymore. This is fairly done automatically when you install <code class=\"language-text\">nvidia-driver</code>, but just to make sure, run the command below if needed.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/modprobe.d/nvidia-blacklists-nouveau.conf\n\n<span class=\"token comment\"># inside the editor, append these</span>\nblacklist nouveau\nblacklist lbm-nouveau\noptions nouveau <span class=\"token assign-left variable\">modeset</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n<span class=\"token builtin class-name\">alias</span> nouveau off\n<span class=\"token builtin class-name\">alias</span> lbm-nouveau off</code></pre></div>\n<ol start=\"5\">\n<li>Update the kernal with the new config with </li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> update-initramfs -u</code></pre></div>\n<ol start=\"6\">\n<li>Reboot your computer</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">reboot</span> -f</code></pre></div>\n<ol start=\"7\">\n<li>Check if <code class=\"language-text\">nouveau</code> is not coming up in the processes</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">lsmod <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -i nouveau <span class=\"token comment\"># should output nothing</span></code></pre></div>\n<ol start=\"8\">\n<li>Edit <code class=\"language-text\">/etc/X11/xorg.conf</code> to accommodate Nvidia</li>\n</ol>\n<p>First, just to prepare for the case where something goes wrong (although there are other ways of repairing it), run:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> /etc/X11/xorg.conf\n\n<span class=\"token function\">cp</span> xorg.conf xorg.mybackup.conf</code></pre></div>\n<p>Find which busID your Nvidia graphics card is assigned with</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ lspci <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> VGA\n00:02.0 VGA compatible controller: Intel Corporation CometLake-H GT2 <span class=\"token punctuation\">[</span>UHD Graphics<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>rev 05<span class=\"token punctuation\">)</span>\n01:00.0 VGA compatible controller: NVIDIA Corporation GA104M <span class=\"token punctuation\">[</span>GeForce RTX <span class=\"token number\">3070</span> Mobile / Max-Q<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">(</span>rev a1<span class=\"token punctuation\">)</span></code></pre></div>\n<p>On my laptop, it’s assigned with <code class=\"language-text\">01:00.0</code>.</p>\n<p>Double check with <code class=\"language-text\">nvidia-xconfig</code>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">nvidia-xconfig --query-gpu-info\n\nNumber of GPUs: <span class=\"token number\">1</span>\n\nGPU <span class=\"token comment\">#0:</span>\n  Name      <span class=\"token builtin class-name\">:</span> NVIDIA GeForce RTX <span class=\"token number\">3070</span> Laptop GPU\n  UUID      <span class=\"token builtin class-name\">:</span> GPU-ab8f0c77-3c86-5204-3382-9f7378122f8d\n  PCI BusID <span class=\"token builtin class-name\">:</span> PCI:1:0:0 <span class=\"token comment\"># &lt;-- this is what we are looking for</span>\n\n  Number of Display Devices: <span class=\"token punctuation\">..</span>.</code></pre></div>\n<p><a href=\"https://forums.developer.nvidia.com/t/lspci-vs-nvidia-smi-vs-nvidia-xconfig-reporting-different-pci-busid/65634\">FYI, <code class=\"language-text\">lspci</code> uses hex to display BusID and <code class=\"language-text\">nvidia-xconfig</code> uses decimal values, which is the reason they may appear different if the number is beyond 10</a>. In your <code class=\"language-text\">xorg.conf</code>, feed the decimal value. </p>\n<p>Then, overwrite this into your <code class=\"language-text\">xorg.conf</code>, and change <code class=\"language-text\">BusID</code> if needed.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># nvidia-xconfig: X configuration file generated by nvidia-xconfig</span>\n<span class=\"token comment\"># nvidia-xconfig:  version 460.32.03</span>\n\nSection <span class=\"token string\">\"ServerLayout\"</span>\n    Identifier     <span class=\"token string\">\"Layout0\"</span>\n    Screen      <span class=\"token number\">0</span>  <span class=\"token string\">\"nvidia\"</span> <span class=\"token comment\"># this part</span>\n    InputDevice    <span class=\"token string\">\"Keyboard0\"</span> <span class=\"token string\">\"CoreKeyboard\"</span>\n    InputDevice    <span class=\"token string\">\"Mouse0\"</span> <span class=\"token string\">\"CorePointer\"</span>\nEndSection\n\nSection <span class=\"token string\">\"Files\"</span>\nEndSection\n\n<span class=\"token comment\"># DO NOT TOUCH THIS ONE</span>\nSection <span class=\"token string\">\"InputDevice\"</span>\n    <span class=\"token comment\"># generated from default</span>\n    Identifier     <span class=\"token string\">\"Mouse0\"</span>\n    Driver         <span class=\"token string\">\"mouse\"</span>\n    Option         <span class=\"token string\">\"Protocol\"</span> <span class=\"token string\">\"auto\"</span>\n    Option         <span class=\"token string\">\"Device\"</span> <span class=\"token string\">\"/dev/psaux\"</span>\n    Option         <span class=\"token string\">\"Emulate3Buttons\"</span> <span class=\"token string\">\"no\"</span>\n    Option         <span class=\"token string\">\"ZAxisMapping\"</span> <span class=\"token string\">\"4 5\"</span>\nEndSection\n\n<span class=\"token comment\"># DO NOT TOUCH THIS ONE</span>\nSection <span class=\"token string\">\"InputDevice\"</span>\n    <span class=\"token comment\"># generated from default</span>\n    Identifier     <span class=\"token string\">\"Keyboard0\"</span>\n    Driver         <span class=\"token string\">\"kbd\"</span>\nEndSection\n\nSection <span class=\"token string\">\"Monitor\"</span>\n    Identifier     <span class=\"token string\">\"Monitor0\"</span>\n    VendorName     <span class=\"token string\">\"Unknown\"</span>\n    ModelName      <span class=\"token string\">\"Unknown\"</span>\n    Option         <span class=\"token string\">\"DPMS\"</span>\nEndSection\n\n<span class=\"token comment\"># NVIDIA</span>\nSection <span class=\"token string\">\"Device\"</span>\n    Identifier     <span class=\"token string\">\"nvidia\"</span>\n    Driver         <span class=\"token string\">\"nvidia\"</span>\n    VendorName     <span class=\"token string\">\"NVIDIA Corporation\"</span>\n    BusID          <span class=\"token string\">\"PCI:1:0:0\"</span> <span class=\"token comment\">#### &lt;----- CHANGE THIS TO YOUR BUSID</span>\nEndSection\n\nSection <span class=\"token string\">\"Screen\"</span>\n    Identifier <span class=\"token string\">\"nvidia\"</span>\n    Device <span class=\"token string\">\"nvidia\"</span>\n    Option <span class=\"token string\">\"AllowEmptyInitialConfiguration\"</span>\nEndSection\n\n<span class=\"token comment\"># INTEL</span>\nSection <span class=\"token string\">\"Device\"</span>\n    Identifier <span class=\"token string\">\"intel\"</span>\n    Driver <span class=\"token string\">\"modesetting\"</span>\nEndSection\n\nSection <span class=\"token string\">\"Screen\"</span>\n    Identifier <span class=\"token string\">\"intel\"</span>\n    Device <span class=\"token string\">\"intel\"</span>\nEndSection</code></pre></div>\n<p>If you are still curious about which bits changed, look at this diff:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7275fec6e51599316439fd3990faa984/302a4/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 133.78378378378378%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAIAAADzvTiPAAAACXBIWXMAAA+IAAAPiAEWyKWGAAACE0lEQVQ4y5WU626bQBCFbTA3G5vYxokcR236I7Bc9grLgjFO0sip+v4v1MFxK1VxC0ijFRL77ZxzmGXkcuGXzTJvfFJt5POMV1NWuXw/pZWNlR5lo5B/Lg2J9tX28PZwPO2a05fmx7eXn/fNaZEdvOwwY9UkzmHTVXgMhbLRvDjeHk7r+s2hFQDteU90FLDLeo28FJxrYjUlpUNLCxdGlGv/2f0Z1hF7kIXHlJNmj0p5RIIeI8m1f7j9G07ytTqCTxPLVdFAVPAMBYa7Ya98vSm/27w2MCgv24Zg9aM64RnLoWzCzZTpEYQ0xPOUZn5Z39XNptyvin2rtrPnH1jD1Vy+mqw26X4lX5by6PK62/AH7Ir8RioLEzMhFuaTWOowG5HoKTv38tJXNWie0pbsa/ssW/n1yS2eLV7fN+8g20yL3oExNcv2Y9CJuHa2OkaiLzzn4pYzGKwJErOQGiEbkLaOxJ2UHoMrJraqcHAO4znuCVs439S1CbOFuCeVK6RNlB5nPdMuXaocXIBVLaBaMES2iUQYi3WcWYg/RXyFhownXODHkO9Cbgd8i7jVkwxY+2k0xHaUfCVkQYgVs74TErB2nKyU+ipeZOlaxQ7FNiEOIbBqEeuGVyp2BdZ/9xyjS/XqDN2WMvHyZC5SI6XDZLsiBc0g1UrJJKGjcAjsUHLunIIECG8YDH9cVxRGwjsSugb/Ag3ZyttfuymBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"xorg.conf\"\n        title=\"xorg.conf\"\n        src=\"/static/7275fec6e51599316439fd3990faa984/fcda8/7.png\"\n        srcset=\"/static/7275fec6e51599316439fd3990faa984/12f09/7.png 148w,\n/static/7275fec6e51599316439fd3990faa984/e4a3f/7.png 295w,\n/static/7275fec6e51599316439fd3990faa984/fcda8/7.png 590w,\n/static/7275fec6e51599316439fd3990faa984/efc66/7.png 885w,\n/static/7275fec6e51599316439fd3990faa984/302a4/7.png 1080w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"9\">\n<li>Configure <code class=\"language-text\">xrandr</code></li>\n</ol>\n<p>Set the providers and rock</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">xrandr --setprovideroutputsource <span class=\"token number\">1</span> <span class=\"token number\">0</span>\nxrandr --auto</code></pre></div>\n<p>And then your external monitors should come up. Yay!</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/60976be2e61a97e12a644ef3d96bd06f/d2602/4.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.08108108108109%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAMEAgX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAWpkya6BER//xAAcEAACAgIDAAAAAAAAAAAAAAAAAQIDBBMUIUL/2gAIAQEAAQUCV61V5conNmeV2JH/xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8BrH//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAbEAEBAAEFAAAAAAAAAAAAAAABABECECIxcf/aAAgBAQAGPwJDIhOeV0Wrydv/xAAbEAEAAQUBAAAAAAAAAAAAAAABABEhMVGBQf/aAAgBAQABPyHemsWu6VcRbB8g9IJcPCFTBP/aAAwDAQACAAMAAAAQGz//xAAXEQEBAQEAAAAAAAAAAAAAAAABABEh/9oACAEDAQE/EAr21f/EABcRAQADAAAAAAAAAAAAAAAAAAABESH/2gAIAQIBAT8QjFv/xAAcEAEAAwACAwAAAAAAAAAAAAABABEhQVFhkcH/2gAIAQEAAT8QefYjOVXMuRaRFLC6U/YhUuo+yKUPAV31ArTeS5//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Multiple external monitors on an Optimus laptop running Kali linux\"\n        title=\"Multiple external monitors on an Optimus laptop running Kali linux\"\n        src=\"/static/60976be2e61a97e12a644ef3d96bd06f/1c72d/4.jpg\"\n        srcset=\"/static/60976be2e61a97e12a644ef3d96bd06f/a80bd/4.jpg 148w,\n/static/60976be2e61a97e12a644ef3d96bd06f/1c91a/4.jpg 295w,\n/static/60976be2e61a97e12a644ef3d96bd06f/1c72d/4.jpg 590w,\n/static/60976be2e61a97e12a644ef3d96bd06f/a8a14/4.jpg 885w,\n/static/60976be2e61a97e12a644ef3d96bd06f/fbd2c/4.jpg 1180w,\n/static/60976be2e61a97e12a644ef3d96bd06f/d2602/4.jpg 4032w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ol start=\"10\">\n<li>(Bonus) Add step 9 as a startup script</li>\n</ol>\n<p>If you don’t set up a startup script, you will need to run this every single time you start your machine:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">xrandr --setprovideroutputsource 1 0\nxrandr --auto</code></pre></div>\n<p>That’s why adding it as a startup script is recommended. It’s a bit tricky because <code class=\"language-text\">xrandr</code>-related startup scripts may not work if fired too early. You have various options to put the script in, but <a href=\"https://unix.stackexchange.com/questions/331398/starting-script-to-set-monitor-configuration\">this stackoverflow answer is lit, so you need to look at it</a>.</p>\n<p>This is how I would do it:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">vim</span> /etc/X11/Xsession.d/99setup-externalmonitors\n\n<span class=\"token comment\"># put this in</span>\n<span class=\"token punctuation\">(</span>sleep <span class=\"token number\">5</span><span class=\"token punctuation\">;</span> xrandr --setprovideroutputsource <span class=\"token number\">1</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> xrandr --auto<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;</span></code></pre></div>\n<p>Note that changing the preceding number of the script may have an effect as well because the scripts are sorted by name and invoked. I noticed that the commands I use need to be called as late as possible. So I kind of hacked into it, and found the above command with <code class=\"language-text\">sleep</code> will reasonably work all the time. It will run around 5 seconds after you get logged in, which is enough for other things to get set up. If you still don’t find it working, try to fiddle with the order a bit more.</p>\n<p>And so that’s all of the magic needed to be done. I hope you really got it to work… if things did not work and you got them working somehow by tweaking some bits, please leave it as a comment so that others can look at it. Thank you.</p>","frontmatter":{"title":"Set up multiple monitors on Optimus laptop running Kali linux","date":"September 17, 2021"}}},"pageContext":{"slug":"/2021-09-17--set-up-multiple-monitors-on-optimus-laptop-running-kali-linux/","previous":{"fields":{"slug":"/2021-03-13-complete-end-to-end-guide-for-developing-dockerized-lambda-with-typescript-terraform-and-SAM-cli/"},"frontmatter":{"title":"Complete end-to-end guide for developing dockerized lambda in Typescript, Terraform and SAM CLI"}},"next":null}},"staticQueryHashes":["3128451518","426816048"]}