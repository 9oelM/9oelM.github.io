{"componentChunkName":"component---src-templates-blog-post-js","path":"/2018-05-29--Some-hacking-notes/","result":{"data":{"site":{"siteMetadata":{"title":"Joel's dev blog","author":"Joel Mun","siteUrl":"https://joel.is-a.dev"}},"markdownRemark":{"id":"f6224359-39f0-5511-be2d-2bc559defe42","excerpt":"detecting security incidents event logs by SANS Regular Expressions to look for Keys to Check       Domain controller Monitoring Active Directory for signs of…","html":"<p><a href=\"https://www.sans.org/reading-room/whitepapers/logging/detecting-security-incidents-windows-workstation-event-logs-34262\">detecting security incidents event logs by SANS</a></p>\n<h2 id=\"regular-expressions-to-look-for\" style=\"position:relative;\">Regular Expressions to look for<a href=\"#regular-expressions-to-look-for\" aria-label=\"regular expressions to look for permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\".*APPCRASH.*\" Application 1001\n\n\".*he protected system file.*\" Application 64004\n\n\".*EMET_DLL Module logged the following event:.*\" Application 2\n\n.*your virus/spyware.* Application Varies\n\n\".*A new process has been created\\..*\" Security 4688\n\n\".*A service was installed in the system\\..*\" Security 4697\n\n\".*A scheduled task was created\\..*\" Security 4698\n\n\".*Logon Type:[\\W]*(3|10).*\" Security 4624, 4625\n\n\".*\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run.*\" Security 4657\n\n\".*service terminated unexpectedly\\..*\" System 7034\n\n\".*service was successfully sent a.*\" System 7035\n\n\".*service entered the.*\" System 7036\n\n\".*service was changed from.*\" System 7040\n\nCreate and install a new service. (EventID 601|4697)\n\nCreate a new scheduled task. (EventID 602|4698)\n\nModify the registry keys so the service is started at boot. (EventID 567|4657)\n\nThe &lt;protection mechanism service > terminated unexpectedly.* (EventID 7034)\n\nThe &lt;protection mechanism service > was successfully sent a .* (EventID 7035)\n\nThe &lt;protection mechanism service > entered the stopped state.* (EventID 7036)\n\nThe &lt;protection mechanism service >service was change from.* (EventID 7040)</code></pre></div>\n<h2 id=\"keys-to-check\" style=\"position:relative;\">Keys to Check<a href=\"#keys-to-check\" aria-label=\"keys to check permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li><code class=\"language-text\">HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code></li>\n<li><code class=\"language-text\">HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce</code></li>\n<li><code class=\"language-text\">HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx</code></li>\n<li><code class=\"language-text\">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run</code></li>\n<li><code class=\"language-text\">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Runonce</code></li>\n<li><code class=\"language-text\">HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunonceEx</code></li>\n</ul>\n<h2 id=\"domain-controller\" style=\"position:relative;\">Domain controller<a href=\"#domain-controller\" aria-label=\"domain controller permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p><a href=\"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/monitoring-active-directory-for-signs-of-compromise\">Monitoring Active Directory for signs of compromise</a></p>\n<p>Check current audit settings (off, on, …)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">auditpol /get /category:\\*</code></pre></div>\n<h2 id=\"maltego\" style=\"position:relative;\">Maltego<a href=\"#maltego\" aria-label=\"maltego permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>Try to use maltego on kali?</p>\n<h2 id=\"nmap\" style=\"position:relative;\">Nmap<a href=\"#nmap\" aria-label=\"nmap permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li><a href=\"https://nmap.org/book/vscan.html\">nmap website</a></li>\n<li><a href=\"https://www.packtpub.com/mapt/book/networking_and_servers/9781784392918/2/ch02lvl1sec18/scanning-and-identifying-services-with-nmap\">nmap kind instruction</a></li>\n<li><a href=\"https://medium.com/@avirj/nmap-tcp-syn-scan-50106f818bf1\">nmap tcp SYN connection</a></li>\n<li><a href=\"https://nmap.org/book/man-port-scanning-techniques.html\">nmap tcp port scanning techniques</a></li>\n</ul>\n<p>Maybe use <code class=\"language-text\">nmap</code> again?</p>\n<p>Scan to detect service and version on all ports</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nmap -sV --allports [ip]</code></pre></div>\n<p>Version detection</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nmap -sV -T4 -F insecure.org\n\nStarting Nmap ( http://nmap.org )\nNmap scan report for insecure.org (74.207.254.18)\nHost is up (0.016s latency).\nrDNS record for 74.207.254.18: web.insecure.org\nNot shown: 95 filtered ports\nPORT    STATE  SERVICE  VERSION\n22/tcp  open   ssh      OpenSSH 4.3 (protocol 2.0)\n25/tcp  open   smtp     Postfix smtpd\n80/tcp  open   http     Apache httpd 2.2.3 ((CentOS))\n113/tcp closed auth\n443/tcp open   ssl/http Apache httpd 2.2.3 ((CentOS))\nService Info: Host:  web.insecure.org\n\nNmap done: 1 IP address (1 host up) scanned in 14.82 seconds</code></pre></div>\n<p>tcp SYN scan</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nmap -sS -p[port1, port2, port3..] ipaddress</code></pre></div>\n<p>tcp connect scan</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nmap -sT -p[port1, port2, port3..] ipaddress</code></pre></div>\n<p>udp scan</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nmap -sU ipaddress</code></pre></div>\n<p>Complex version detection</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># nmap -A -T4 localhost \n\nStarting Nmap ( http://nmap.org )\nNmap scan report for felix (127.0.0.1)\n(The 1640 ports scanned but not shown below are in state: closed)\nPORT     STATE SERVICE    VERSION\n21/tcp   open  ftp        WU-FTPD wu-2.6.1-20\n22/tcp   open  ssh        OpenSSH 3.1p1 (protocol 1.99)\n53/tcp   open  domain     ISC BIND 9.2.1\n79/tcp   open  finger     Linux fingerd\n111/tcp  open  rpcbind    2 (rpc #100000)\n443/tcp  open  ssl/http   Apache httpd 2.0.39 ((Unix) mod_perl/1.99_04-dev)\n515/tcp  open  printer\n631/tcp  open  ipp        CUPS 1.1\n953/tcp  open  rndc?\n5000/tcp open  ssl/ftp    WU-FTPD wu-2.6.1-20\n5001/tcp open  ssl/ssh    OpenSSH 3.1p1 (protocol 1.99)\n5002/tcp open  ssl/domain ISC BIND 9.2.1\n5003/tcp open  ssl/finger Linux fingerd\n6000/tcp open  X11        (access denied)\n8000/tcp open  http-proxy Junkbuster webproxy\n8080/tcp open  http       Apache httpd 2.0.39 ((Unix) mod_perl/1.99_04-dev)\n8081/tcp open  http       Apache httpd 2.0.39 ((Unix) mod_perl/1.99_04-dev)\nDevice type: general purpose\nRunning: Linux 2.4.X|2.5.X\nOS details: Linux Kernel 2.4.0 - 2.5.20\n\nNmap finished: 1 IP address (1 host up) scanned in 42.494 seconds</code></pre></div>\n<p>save to a file</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nmap -oN outputfile.txt 192.168.1.1 (Save default output to file)</code></pre></div>\n<h2 id=\"netstat\" style=\"position:relative;\">netstat<a href=\"#netstat\" aria-label=\"netstat permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">netstat –antp\n\n-a all\n-n show ip instead of host names\n-t show only tcp connections\n-p show process id/name</code></pre></div>\n<h2 id=\"general-guide-to-finding-rootkit-malware-and-backdoor\" style=\"position:relative;\">General guide to finding rootkit, malware and backdoor<a href=\"#general-guide-to-finding-rootkit-malware-and-backdoor\" aria-label=\"general guide to finding rootkit malware and backdoor permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li><a href=\"https://askubuntu.com/questions/325929/malware-and-backdoor-detection-shell-script\">askubuntu</a></li>\n<li><a href=\"https://security.stackexchange.com/questions/126399/finding-a-backdoor-on-a-server\">stackexchange</a></li>\n</ul>\n<h2 id=\"dont-forget-the-basics-just-simple-network-commands\" style=\"position:relative;\">Don’t forget the basics: just simple network commands<a href=\"#dont-forget-the-basics-just-simple-network-commands\" aria-label=\"dont forget the basics just simple network commands permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">route print\narp -a\nnslookup\nipconfig /displaydns</code></pre></div>\n<h2 id=\"iptables\" style=\"position:relative;\">iptables<a href=\"#iptables\" aria-label=\"iptables permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<ul>\n<li><a href=\"https://www.digitalocean.com/community/tutorials/iptables-essentials-common-firewall-rules-and-commands\">iptables guide</a></li>\n<li><a href=\"https://www.howtogeek.com/177621/the-beginners-guide-to-iptables-the-linux-firewall/\">howtogeekguide</a></li>\n</ul>\n<h3 id=\"understanding-the-concept\" style=\"position:relative;\">Understanding the concept<a href=\"#understanding-the-concept\" aria-label=\"understanding the concept permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>There are 3 types of chains (directly copied from howtogeek):</p>\n<ul>\n<li><strong>Input</strong> – This chain is used to control the behavior for incoming connections. For example, if a user attempts to SSH into your PC/server, iptables will attempt to match the IP address and port to a rule in the input chain.</li>\n<li><strong>Forward</strong> – This chain is used for incoming connections that aren’t actually being delivered locally. <strong>Think of a router</strong> – data is always being sent to it but rarely actually destined for the router itself; the data is just forwarded to its target. Unless you’re doing some kind of routing, NATing, or something else on your system that requires forwarding, you won’t even use this chain.</li>\n<li><strong>Output</strong> - This chain is used for outgoing connections. For example, if you try to ping howtogeek.com, iptables will check its output chain to see what the rules are regarding ping and howtogeek.com before making a decision to allow or deny the connection attempt.</li>\n</ul>\n<h4 id=\"check-if-your-computer-is-forwarding-something\" style=\"position:relative;\">Check if your computer is forwarding something<a href=\"#check-if-your-computer-is-forwarding-something\" aria-label=\"check if your computer is forwarding something permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">iptables -L -v</code></pre></div>\n<p><img src=\"https://www.howtogeek.com/wp-content/uploads/2013/12/x2-packets-processed.jpg.pagespeed.gp+jp+jw+pj+ws+js+rj+rp+rw+ri+cp+md.ic.lkpdv2BXzd.jpg\" alt=\"result\"></p>\n<p>If <code class=\"language-text\">Chain forward</code> shows nothing, you are good to go to close <code class=\"language-text\">forward</code> chain down.</p>\n<h4 id=\"syntax-to-block-an-ip-address\" style=\"position:relative;\">Syntax to block an IP address<a href=\"#syntax-to-block-an-ip-address\" aria-label=\"syntax to block an ip address permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">iptables -A INPUT -s IP-ADDRESS -j DROP</code></pre></div>\n<h4 id=\"syntax-to-block-by-port\" style=\"position:relative;\">Syntax to block by port<a href=\"#syntax-to-block-by-port\" aria-label=\"syntax to block by port permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">iptables -A INPUT -j DROP -p tcp --destination-port [port number] -i [if any interface related]</code></pre></div>\n<h3 id=\"what-to-do-priority-from-top-to-bottom\" style=\"position:relative;\">What to do (priority from top to bottom)<a href=\"#what-to-do-priority-from-top-to-bottom\" aria-label=\"what to do priority from top to bottom permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">It is advisable to use iptables in Linux to enforce firewall policies. \nSince the range is a private network, it does need to have firewall policies that would block all connections in and out from unrecognized hosts. Moreover, HBSS and McAfee (or any other antivirus) not installed and network IDS down. This is a perfect reason to set up iptables policy locally on linux computers (rha and rhb). Commenting is done after \"#\" for convenience. \n\nThis is how:\n\n# Accept INPUT packets from and OUTPUT packets to devices inside the subnet only\niptables -A INPUT -s 10.98.10.0/24 -j ACCEPT\niptables -A OUTPUT -s 10.98.10.0/24 -j ACCEPT\n\n# Only accept the necessary ports that are being used for the server\n# For example, to allow http by any chance:\niptables -A OUTPUT -j ACCEPT -p tcp --destination-port 80\n\n... there would be other specific rules on the allowed ports, in accordance with the services being run on the computer. For now, we just get the idea of allowing ports on specific services. ...\n\n# Drop all packets on all ports processed by OUTPUT. This would protect the machine from being compromised to keep persistence.\n\niptables -A OUTPUT -p udp --match multiport --dports 0:65535 -j DROP\niptables -A OUTPUT -p tcp --match multiport --dports 0:65535 -j DROP\n\n# Drop all packets processed by INPUT, FORWARD, OUTPUT by default.\n# This would include, for example, blocking an icmp packet from an unknown host from any hosts outside of the subnet.\niptables -P INPUT DROP\niptables -P FORWARD DROP\niptables -P OUTPUT DROP\n\n# After that, save configurations\nsudo service iptables save</code></pre></div>\n<h2 id=\"c-print-admin-ipc\" style=\"position:relative;\">C<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo separator=\"true\">,</mo><mi>p</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">, print</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.85396em;vertical-align:-0.19444em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span></span></span></span></span>, Admin<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo separator=\"true\">,</mo><mi>I</mi><mi>P</mi><mi>C</mi></mrow><annotation encoding=\"application/x-tex\">, IPC</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><a href=\"#c-print-admin-ipc\" aria-label=\"c print admin ipc permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h2 id=\"using-metaexploit-to-audit\" style=\"position:relative;\">Using metaexploit to audit<a href=\"#using-metaexploit-to-audit\" aria-label=\"using metaexploit to audit permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"search\" style=\"position:relative;\">Search<a href=\"#search\" aria-label=\"search permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">msf > help search\nUsage: search [keywords]\n\nKeywords:\n  app       :  Modules that are client or server attacks\n  author    :  Modules written by this author\n  bid       :  Modules with a matching Bugtraq ID\n  cve       :  Modules with a matching CVE ID\n  edb       :  Modules with a matching Exploit-DB ID\n  name      :  Modules with a matching descriptive name\n  platform  :  Modules affecting this platform\n  ref       :  Modules with a matching ref\n  type      :  Modules of a specific type (exploit, auxiliary, or post)\n\nExamples:\n\nsearch cve:2009 type:exploit app:client\n\nsearch name:[name of exploit, e.g smb/rpc/http] type:[exploit/payload/auxillary] platform:[windows/linux etc.]\n\nand I believe search port: is also available?</code></pre></div>\n<h2 id=\"syslog-format\" style=\"position:relative;\">Syslog format<a href=\"#syslog-format\" aria-label=\"syslog format permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h2 id=\"others\" style=\"position:relative;\">Others<a href=\"#others\" aria-label=\"others permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>also look at</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">/var/log/secure</code></pre></div>\n<p>and check user permissions using</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\"AccessChk\" and \"AccessEnum\"</code></pre></div>\n<p>helpful links for windows domain controller security</p>\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/monitoring-active-directory-for-signs-of-compromise\">Monitoring Active Directory for Signs of Compromise</a></li>\n</ul>\n<h2 id=\"windows-registry\" style=\"position:relative;\">Windows Registry<a href=\"#windows-registry\" aria-label=\"windows registry permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<h3 id=\"sources\" style=\"position:relative;\">Sources<a href=\"#sources\" aria-label=\"sources permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<ul>\n<li><a href=\"https://support.microsoft.com/en-us/help/256986/windows-registry-information-for-advanced-users\">microsoft MSDN</a></li>\n<li><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms724182(v=vs.85).aspx\">microsoft MSDN 2</a></li>\n<li><a href=\"https://help.comodo.com/topic-159-1-290-3248-.html\">comodo.com</a></li>\n</ul>\n<h3 id=\"what-is-it\" style=\"position:relative;\">What is it<a href=\"#what-is-it\" aria-label=\"what is it permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<blockquote>\n<p>“A central hierarchical database used in Microsoft Windows 98, Windows CE, Windows NT, and Windows 2000 <strong>used to store information that is necessary to configure the system</strong> for one or more users, applications and hardware devices.”</p>\n</blockquote>\n<blockquote>\n<p>The Registry contains information that Windows <strong>continually references during operation</strong>, such as profiles for each user, the applications installed on the computer and the types of documents that each can create, property sheet settings for folders and application icons, what hardware exists on the system, and the ports that are being used.</p>\n</blockquote>\n<h3 id=\"predefined-registry-keys-copied-directly-from-microsoft\" style=\"position:relative;\">Predefined registry keys (copied directly from microsoft)<a href=\"#predefined-registry-keys-copied-directly-from-microsoft\" aria-label=\"predefined registry keys copied directly from microsoft permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HKEY_CURRENT_USER\tContains the root of the configuration information for the user who is currently logged on. The user's folders, screen colors, and Control Panel settings are stored here. This information is associated with the user's profile. This key is sometimes abbreviated as \"HKCU.\"\n\nHKEY_USERS\tContains all the actively loaded user profiles on the computer. \n\nHKEY_CURRENT_USER is a subkey of HKEY_USERS. HKEY_USERS is sometimes abbreviated as \"HKU.\"\n\nHKEY_LOCAL_MACHINE\tContains configuration information particular to the computer (for any user). This key is sometimes abbreviated as \"HKLM.\"\n\nHKEY_CLASSES_ROOT\t\nIs a subkey of HKEY_LOCAL_MACHINE\\Software. The information that is stored here makes sure that the correct program opens when you open a file by using Windows Explorer. This key is sometimes abbreviated as \"HKCR.\" Starting with Windows 2000, this information is stored under both the HKEY_LOCAL_MACHINE and HKEY_CURRENT_USER keys. The HKEY_LOCAL_MACHINE\\Software\\Classes key contains default settings that can apply to all users on the local computer. The HKEY_CURRENT_USER\\Software\\Classes key contains settings that override the default settings and apply only to the interactive user. The HKEY_CLASSES_ROOT key provides a view of the registry that merges the information from these two sources. HKEY_CLASSES_ROOT also provides this merged view for programs that are designed for earlier versions of Windows. To change the settings for the interactive user, changes must be made under HKEY_CURRENT_USER\\Software\\Classes instead of under HKEY_CLASSES_ROOT. To change the default settings, changes must be made under HKEY_LOCAL_MACHINE\\Software\\Classes. If you write keys to a key under HKEY_CLASSES_ROOT, the system stores the information under HKEY_LOCAL_MACHINE\\Software\\Classes. If you write values to a key under HKEY_CLASSES_ROOT, and the key already exists under HKEY_CURRENT_USER\\Software\\Classes, the system will store the information there instead of under HKEY_LOCAL_MACHINE\\Software\\Classes.\n\nHKEY_CURRENT_CONFIG\tContains information about the hardware profile that is used by the local computer at system startup.</code></pre></div>\n<h3 id=\"jargons-and-registry-structure\" style=\"position:relative;\">Jargons and registry structure<a href=\"#jargons-and-registry-structure\" aria-label=\"jargons and registry structure permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">HKEY_LOCAL_MACHINE  --> Called 'Hive'\n|\n--HARDWARE --> Called 'Key'\n|\n--SAM\n|\n--SECURITY\n|\n--SOFTWARE\n    |\n    --...\n    |\n    --Google --> Called 'Subkey'\n    |\n    --Other apps</code></pre></div>","frontmatter":{"title":"Some hacking notes","date":"May 29, 2018","keywords":null}}},"pageContext":{"slug":"/2018-05-29--Some-hacking-notes/","previous":{"fields":{"slug":"/2018-05-19--Using-foresic-tools-(1):-process-explorer,-process-monitor,-and-autoruns/"},"frontmatter":{"title":"Using foresic tools (1): process explorer, process monitor, and autoruns","tab":"post","tags":["hacking"],"keywords":null}},"next":{"fields":{"slug":"/2018-06-30--This-&-Object-prototypes-(2):-this-All-Makes-Sense-Now!/"},"frontmatter":{"title":"This & Object prototypes (2): this All Makes Sense Now!","tab":"post","tags":["development","javascript"],"keywords":null}}}},"staticQueryHashes":["3128451518","426816048"]}