<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Noto Sans KR',sans-serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Noto Sans KR',sans-serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Noto Sans KR,sans-serif !important;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Noto Sans KR',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Noto Sans KR',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Noto Sans KR',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Noto Sans KR',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Noto Sans KR',sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);border-left-color:#E0E0E0;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);border-color:#E0E0E0;}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#80DEEA;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor > svg{visibility:visible !important;fill:#80DEEA;}p,small,h1,h2,h3,h4,li,ul,td,th{color:#E0E0E0;}html,body{background-color:#212121;}</style><style data-href="/styles.6f663e5889517bf077af.css" id="gatsby-global-css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.gatsby-highlight-code-line{background-color:#feb;display:block;margin-right:-1em;margin-left:-1em;padding-right:1em;padding-left:.75em;border-left:.25em solid #f99}#gatsby-focus-wrapper{background-color:#212121}.navigation-link:hover{background-color:rgba(0,255,255,.219);transition:.3s}pre code{white-space:pre-wrap!important;white-space:-moz-pre-wrap!important;white-space:-pre-wrap!important;white-space:-o-pre-wrap!important;word-wrap:break-word!important}</style><meta name="generator" content="Gatsby 2.32.11"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#009688"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><title data-react-helmet="true">Practical Emscripten &amp; Webassembly: Simple RISC-V Simulator on the web | Joel&#x27;s dev blog</title><meta data-react-helmet="true" name="description" content="So I have enrolled in this computer architecture class for the current semester. The lecture is based on the RISC-V instruction set, which was quite of a…"/><meta data-react-helmet="true" name="keywords" content="webassembly, risc-v, emulator, simulator, web"/><meta data-react-helmet="true" name="author" content="Joel Mun"/><meta data-react-helmet="true" name="copyright" content="Joel Mun"/><meta data-react-helmet="true" property="og:title" content="Practical Emscripten &amp; Webassembly: Simple RISC-V Simulator on the web"/><meta data-react-helmet="true" property="og:description" content="So I have enrolled in this computer architecture class for the current semester. The lecture is based on the RISC-V instruction set, which was quite of a…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Joel Mun"/><meta data-react-helmet="true" name="twitter:title" content="Practical Emscripten &amp; Webassembly: Simple RISC-V Simulator on the web"/><meta data-react-helmet="true" name="twitter:description" content="So I have enrolled in this computer architecture class for the current semester. The lecture is based on the RISC-V instruction set, which was quite of a…"/><meta data-react-helmet="true" http-equiv="cache-control" content="max-age=0"/><meta data-react-helmet="true" http-equiv="cache-control" content="no-cache"/><meta data-react-helmet="true" http-equiv="expires" content="0"/><meta data-react-helmet="true" http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/><meta data-react-helmet="true" http-equiv="pragma" content="no-cache"/><meta data-react-helmet="true" name="google-site-verification" content="Dt05uwJItLiAnlI0X2WgMlaV8GKbS63FimDxxf-Qrxc"/><link href="//fonts.googleapis.com/css?family=Noto+Sans+KR:700|Noto+Sans+KR:400,400i,700,700i,900,900i" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/webpack-runtime-1c1502302e7410b95bca.js"/><link as="script" rel="preload" href="/framework-58f863d6aa18c11a521f.js"/><link as="script" rel="preload" href="/app-a9a1b482fc219c8dbb62.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/commons-0f15d263951f172ebd0e.js"/><link as="script" rel="preload" href="/3aff51721f55eece1e790a7bf464ea83c5b17b16-8f5aee00595b7b0ef6e1.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-8daac0a110424eb1ce6c.js"/><link as="fetch" rel="preload" href="/page-data/2022-05-13-RISC-V-Simulator-On-The-Web/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3128451518.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/426816048.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:70rem;padding:2.625rem 1.3125rem;background-color:#212121"><header><h1 style="font-size:3.95285rem;line-height:4.375rem;margin-bottom:2.625rem;margin-top:0;color:#E0E0E0"><a style="box-shadow:none;text-decoration:none;color:#E0E0E0" href="/">Joel&#x27;s dev blog</a></h1></header><main><a href="https://hits.seeyoufarm.com" style="border:none;color:transparent"><img style="margin-bottom:0" src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2F9oelm.github.io&amp;count_bg=%23848683&amp;title_bg=%23555555&amp;icon=&amp;icon_color=%23E7E7E7&amp;title=hits+since+2022&amp;edge_flat=false"/></a><h1 style="color:#E0E0E0;margin-top:5px">Practical Emscripten &amp; Webassembly: Simple RISC-V Simulator on the web</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem;color:#E0E0E0">May 14, 2022</p><div><p>So I have enrolled in this <a href="https://icsl.yonsei.ac.kr/eee3530/">computer architecture class</a> for the current semester. The lecture is based on <a href="https://riscv.org/wp-content/uploads/2017/05/riscv-spec-v2.2.pdf">the RISC-V instruction set</a>, which was quite of a surprise to me because it is not the popular kind of instruction set in the practical industry yet, although rapidly growing.</p>
<p>And I was looking for some project to do for fun. A few days ago, <a href="https://github.com/9oelM/emscripten-cplusplus-webpack-example">I dug into Emscripten a bit and did some experiment with it</a>, which is what <a href="https://9oelm.github.io/2022-05-10-How-to-compile-C++-code-into-Webassembly-with-Emscripten-and-use-it-in-Webpack-+-Typescript-+-React-project/">my previous blog post</a> is about. Upon thinking about it, I found <a href="https://github.com/yonsei-icsl/Kite">my professor’s simple RISC-V simulator, named Kite</a>, is based on C++. Then everything moved quite quickly because I just found a suitable target to turn into Webassembly for fun. This blog post is a short reflection/how-to-guide for that.</p>
<h2 id="table-of-contents" style="position:relative;">Table of contents<a href="#table-of-contents" aria-label="table of contents permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<div class="table-of-contents">
<ul>
<li><a href="#disclamer">Disclamer</a></li>
<li><a href="#if-you-want-it-first">If you want it first</a></li>
<li><a href="#porting-c-into-a-usable-webassembly">Porting C++ into a usable Webassembly</a></li>
<li><a href="#forwarding-the-output-of-c-to-javascript">Forwarding the output of C++ to Javascript</a></li>
<li><a href="#removing-file-io-and-receiving-input-from-javascript-instead-converting-build-flags-into-runtime-variables-and-allocate-c-variables-in-javascript">Removing file i/o and receiving input from Javascript instead, converting build flags into runtime variables, and allocate C++ variables in Javascript</a></li>
<li><a href="#throwing-the-error-to-javascript">Throwing the error to Javascript</a></li>
<li><a href="#compilation-of-existing-c-into-webassembly">Compilation of existing C++ into Webassembly</a></li>
<li><a href="#reflections--implications">Reflections &#x26; implications</a></li>
</ul>
</div>
<h2 id="disclamer" style="position:relative;">Disclamer<a href="#disclamer" aria-label="disclamer permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>RISC-V simulator I ported to Webassembly is for nothing but fun and probably an educational purpose. It does not support complete set of instructions in RISC-V - actually just a very few of them. But again, in the end, it’s for fun, so I decided to do it.</p>
<h2 id="if-you-want-it-first" style="position:relative;">If you want it first<a href="#if-you-want-it-first" aria-label="if you want it first permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>So here’s the Webassembly-ported version of Kite: <a href="https://riscv.surge.sh">https://riscv.surge.sh</a></p>
<h2 id="porting-c-into-a-usable-webassembly" style="position:relative;">Porting C++ into a usable Webassembly<a href="#porting-c-into-a-usable-webassembly" aria-label="porting c into a usable webassembly permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>But there were a few challenges I needed to tackle:</p>
<ol>
<li>Forwarding the output of C++ out to Javascript, in the form of <code class="language-text">string</code> - that is, not to the console, but as a variable that I can control.</li>
<li>Remove file i/o and receive input from Javascript instead</li>
<li>Convert build flags like <code class="language-text">-DDEBUG</code> into runtime boolean variables and supply them from Javascript.</li>
<li>Throwing an error to Javascript, so that the error can be displayed on the web.</li>
<li>Build C++ into Webassembly, which I already kinda knew how to, because of the research I’ve done previously. But exact flags supplied to Emscripten needed to be different, because Kite is just different from what I previously compiled.</li>
</ol>
<p>I will explain how I tackled each part.</p>
<h2 id="forwarding-the-output-of-c-to-javascript" style="position:relative;">Forwarding the output of C++ to Javascript<a href="#forwarding-the-output-of-c-to-javascript" aria-label="forwarding the output of c to javascript permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>Emscripten naturally forwards all <code class="language-text">std::cout</code> to the browser console. So even if you don’t do anything special, you will just be able to see the output from <code class="language-text">std::cout</code> in the console. </p>
<p>So <code class="language-text">std::cout</code> is how Kite communicates with the user (who is intended to be a developer or at least a CS student). It’s just a console program, so to speak - like below picture.</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/615e0d063f9db1ffdbef29f8e8065f81/5df5d/0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 83.1081081081081%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAABWUlEQVQ4y62U2XKCQBBFiSUmbhEBSSWpfEB2cUV2QRZN/v932u4ZFvVFUB9u9UDB4d6eHoShFYGMUuwYXm2qPnQXLtxPXHiYutD4XoHwuQThy6gmDksQsgYZ68jdwmC1AfoQ1cbPRcAYessAgTFbS2YE3bkPLd3hsDqSLQ4ZGCFoToKwEBQnYg7bU4ruMDC1QBzbTPk9UbdZben8PlVBRQgBX4I/ePNSXAcIDOF5/Q8SRqaX7rCPpYyT62MJIzcFzdvBk79DUAoqinrXxxZ0Zh5zUyvyI0all2lHeYRMkywmxaizKR1sPrlo/lpsRMh2MSofixKWOzgHVBwaFYqasNgqrmmjxLF1/GBVlyyyEbCxaWPPKHoTYeS4FihXDwda87YHg2yWUQ/jVu4huupn7gheDHPdqMVJwRksIO8XbMKpJHPD+3WNq7PAa0Q/AjqHNwMOEVgcrxsA97fK5b7aR6vFAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="0.png"
        title="0.png"
        src="/static/615e0d063f9db1ffdbef29f8e8065f81/fcda8/0.png"
        srcset="/static/615e0d063f9db1ffdbef29f8e8065f81/12f09/0.png 148w,
/static/615e0d063f9db1ffdbef29f8e8065f81/e4a3f/0.png 295w,
/static/615e0d063f9db1ffdbef29f8e8065f81/fcda8/0.png 590w,
/static/615e0d063f9db1ffdbef29f8e8065f81/efc66/0.png 885w,
/static/615e0d063f9db1ffdbef29f8e8065f81/c83ae/0.png 1180w,
/static/615e0d063f9db1ffdbef29f8e8065f81/5df5d/0.png 1572w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>But I had to convert that into <code class="language-text">std::string</code> and send it to javascript. So the solution was quite evident already, at least from the C++ side: direct the output of the program to <code class="language-text">std::ostringstream</code> to store it, and convert it to <code class="language-text">string</code> later. So here’s the difference of the converted code from the original <code class="language-text">main</code> function:</p>
<p><em>original</em></p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> banner <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>argc <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Usage: "</span> <span class="token operator">&lt;&lt;</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" [program_code]"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    proc_t proc<span class="token punctuation">;</span>            <span class="token comment">// Kite processor</span>
    proc<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// Processor initialization</span>
    proc<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">// Processor runs.</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><em>converted</em></p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sstream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"proc.h"</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"string"</span></span>

<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">extern</span> <span class="token string">"C"</span> <span class="token punctuation">{</span>
  <span class="token keyword">inline</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">cstr</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>string <span class="token operator">&amp;</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      <span class="token keyword">auto</span> buffer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      buffer<span class="token punctuation">[</span>message<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'\0'</span><span class="token punctuation">;</span>
      <span class="token function">memcpy</span><span class="token punctuation">(</span>buffer<span class="token punctuation">,</span> message<span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> message<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> buffer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">run_kite_once</span><span class="token punctuation">(</span>
        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>program_code<span class="token punctuation">,</span> 
        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>memory_state<span class="token punctuation">,</span> 
        <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>reg_state<span class="token punctuation">,</span>
        <span class="token keyword">int8_t</span> <span class="token operator">*</span>is_debug_on<span class="token punctuation">,</span>
        <span class="token keyword">int8_t</span> <span class="token operator">*</span>is_data_fwd_on<span class="token punctuation">,</span>
        <span class="token keyword">int8_t</span> <span class="token operator">*</span>is_br_pred_on
      <span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
      proc_t <span class="token operator">*</span>proc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">proc_t</span><span class="token punctuation">(</span>is_debug_on<span class="token punctuation">,</span> is_data_fwd_on<span class="token punctuation">,</span> is_br_pred_on<span class="token punctuation">)</span><span class="token punctuation">;</span>
      proc<span class="token operator">-></span><span class="token function">init</span><span class="token punctuation">(</span>program_code<span class="token punctuation">,</span> memory_state<span class="token punctuation">,</span> reg_state<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Processor initialization</span>
      std<span class="token operator">::</span>ostringstream program_log<span class="token punctuation">;</span>
      proc<span class="token operator">-></span><span class="token function">run</span><span class="token punctuation">(</span>program_log<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Processor runs.</span>
      std<span class="token operator">::</span>string program_output <span class="token operator">=</span> std<span class="token operator">::</span><span class="token function">move</span><span class="token punctuation">(</span>program_log<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      std<span class="token operator">::</span>cout <span class="token operator">&lt;&lt;</span> program_output<span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">cstr</span><span class="token punctuation">(</span>program_output<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Now we declare <code class="language-text">program_log</code> at the topmost caller function, and inside each function that is followed by the caller function (the functions called by <code class="language-text">proc-&gt;run</code>), the program will store its output to <code class="language-text">program_log</code> by running <code class="language-text">program_log &lt;&lt; &quot;blah&quot;</code> instead of <code class="language-text">std::cout &lt;&lt; &quot;blah&quot;</code>.</p>
<p>After everything runs, we convert <code class="language-text">std::ostringstream</code> into <code class="language-text">std::string</code> by writing <code class="language-text">std::string program_output = std::move(program_log).str();</code>. Then we simply <code class="language-text">std::cout &lt;&lt; program_output;</code> for a debugging purpose, and then return <code class="language-text">cstr(program_output)</code>.</p>
<p>What <code class="language-text">cstr</code> does is essentially just to allocate another memory for the string, and copy the string into it, and return the address to it, so that we can use that address to dereference and get the value of the string.</p>
<p>Then, from javascript, you will do something like:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">executionOutputCharPtr <span class="token operator">=</span> <span class="token function">_run_kite_once</span><span class="token punctuation">(</span>
  codeCharPtr<span class="token punctuation">,</span>
  memoryCharPtr<span class="token punctuation">,</span>
  registerCharPtr<span class="token punctuation">,</span>
  isDebugOnInt8Ptr<span class="token punctuation">,</span>
  isDataFwdOnInt8Ptr<span class="token punctuation">,</span>
  isBrPredOnInt8Ptr
<span class="token punctuation">)</span>

<span class="token keyword">const</span> executionOutputInJSString <span class="token operator">=</span> <span class="token function">UTF8ToString</span><span class="token punctuation">(</span>executionOutputCharPtr<span class="token punctuation">)</span>
<span class="token function">setExecutionOutput</span><span class="token punctuation">(</span>executionOutputInJSString<span class="token punctuation">)</span></code></pre></div>
<p><code class="language-text">_run_kite_once</code> will return a pointer to the start of the string, and <code class="language-text">UTF8ToString</code>, which is a function exported from Emscripten, will dereference the pointer and get the value of string. More on exporting the function later.</p>
<h2 id="removing-file-io-and-receiving-input-from-javascript-instead-converting-build-flags-into-runtime-variables-and-allocate-c-variables-in-javascript" style="position:relative;">Removing file i/o and receiving input from Javascript instead, converting build flags into runtime variables, and allocate C++ variables in Javascript<a href="#removing-file-io-and-receiving-input-from-javascript-instead-converting-build-flags-into-runtime-variables-and-allocate-c-variables-in-javascript" aria-label="removing file io and receiving input from javascript instead converting build flags into runtime variables and allocate c variables in javascript permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>Above code also explains how I managed to receive input from Javascript. The original code read local files for program code, register state, and memory state, which look like:</p>
<p><em>register state</em></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">x0 = 0
x1 = 0
x2 = 4000
x3 = 3
x4 = 4
x5 = 5
x6 = 6
x7 = 7
x8 = 8
x9 = 9

...</code></pre></div>
<p><em>memory state</em></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">1024 = 5
1032 = -8
1040 = -4
1048 = 7
1056 = -7
1064 = 7
1072 = -7
1080 = -7
1088 = 5
1096 = 1
1104 = 3
1112 = -1
1120 = -7

...</code></pre></div>
<p><em>program code</em></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">loop:   beq  x11, x0,  exit
        remu x5,  x10, x11
        add  x10, x11, x0
        add  x11, x5,  x0
        beq  x0,  x0,  loop
exit:   sd   x10, 2000(x0)</code></pre></div>
<p>These are all stored in local files and read from the program with <code class="language-text">fstream</code>:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp">    fstream file_stream<span class="token punctuation">;</span>
    file_stream<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"memory_state"</span><span class="token punctuation">,</span> fstream<span class="token operator">::</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>file_stream<span class="token punctuation">.</span><span class="token function">is_open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Error: failed to open memory_state"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    string line<span class="token punctuation">;</span>
    size_t line_num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token function">getline</span><span class="token punctuation">(</span>file_stream<span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre></div>
<p>So all I have to do was remove these lines, and receive the string input instead from javascript. That is what <code class="language-text">_run_kite_once</code> is doing: it receives <code class="language-text">const char *</code> pointers in javascript variables (<code class="language-text">codeCharPtr</code>, <code class="language-text">memoryCharPtr</code>, <code class="language-text">registerCharPtr</code>) containing addresses to the variables in C++.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span>
  _run_kite_once<span class="token punctuation">,</span>
  allocate<span class="token punctuation">,</span>
  <span class="token constant">ALLOC_NORMAL</span><span class="token punctuation">,</span>
  intArrayFromString<span class="token punctuation">,</span>
  _free<span class="token punctuation">,</span>
  UTF8ToString<span class="token punctuation">,</span>
  _get_exception_message<span class="token punctuation">,</span>
  _malloc<span class="token punctuation">,</span>
  setValue<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token operator">=</span> kiteWasmRequestResult<span class="token punctuation">.</span>current
<span class="token keyword">const</span> <span class="token punctuation">{</span> is_debug_on<span class="token punctuation">,</span> is_data_fwd_on<span class="token punctuation">,</span> is_br_pred_on <span class="token punctuation">}</span> <span class="token operator">=</span> RVSSettings

<span class="token keyword">const</span> codeCharPtr <span class="token operator">=</span> <span class="token function">allocate</span><span class="token punctuation">(</span>
  <span class="token function">intArrayFromString</span><span class="token punctuation">(</span>codeState<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token constant">ALLOC_NORMAL</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> memoryCharPtr <span class="token operator">=</span> <span class="token function">allocate</span><span class="token punctuation">(</span>
  <span class="token function">intArrayFromString</span><span class="token punctuation">(</span>memoryState<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token constant">ALLOC_NORMAL</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> registerCharPtr <span class="token operator">=</span> <span class="token function">allocate</span><span class="token punctuation">(</span>
  <span class="token function">intArrayFromString</span><span class="token punctuation">(</span>registerState<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token constant">ALLOC_NORMAL</span>
<span class="token punctuation">)</span>
<span class="token keyword">const</span> isDebugOnInt8Ptr <span class="token operator">=</span> <span class="token function">_malloc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> isDataFwdOnInt8Ptr <span class="token operator">=</span> <span class="token function">_malloc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> isBrPredOnInt8Ptr <span class="token operator">=</span> <span class="token function">_malloc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">setValue</span><span class="token punctuation">(</span>isDebugOnInt8Ptr<span class="token punctuation">,</span> is_debug_on<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token function">setValue</span><span class="token punctuation">(</span>isDataFwdOnInt8Ptr<span class="token punctuation">,</span> is_data_fwd_on<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token function">setValue</span><span class="token punctuation">(</span>isBrPredOnInt8Ptr<span class="token punctuation">,</span> is_br_pred_on<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

executionOutputCharPtr <span class="token operator">=</span> <span class="token function">_run_kite_once</span><span class="token punctuation">(</span>
  codeCharPtr<span class="token punctuation">,</span>
  memoryCharPtr<span class="token punctuation">,</span>
  registerCharPtr<span class="token punctuation">,</span>
  isDebugOnInt8Ptr<span class="token punctuation">,</span>
  isDataFwdOnInt8Ptr<span class="token punctuation">,</span>
  isBrPredOnInt8Ptr
<span class="token punctuation">)</span></code></pre></div>
<p>There is a need to explain <code class="language-text">allocate</code>, <code class="language-text">_malloc</code>, <code class="language-text">setValue</code> as well. Since Javascript is obviously not C++, there needs to be some special way of declaring C++ variables in Javascript if you need to do that. So these are functions that you will want to use.</p>
<p>For example,</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> isDebugOnInt8Ptr <span class="token operator">=</span> <span class="token function">_malloc</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">setValue</span><span class="token punctuation">(</span>isDebugOnInt8Ptr<span class="token punctuation">,</span> is_debug_on<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></code></pre></div>
<p>This line above will allocate 1 byte of memory to store <code class="language-text">i8</code> value of <code class="language-text">is_debug_on</code> in Javascript, and <code class="language-text">isDebugOnInt8Ptr</code> can be now supplied to a function exported to wasm.</p>
<p>Another way to do it is to use <code class="language-text">allocate</code>.</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> memoryCharPtr <span class="token operator">=</span> <span class="token function">allocate</span><span class="token punctuation">(</span>
  <span class="token function">intArrayFromString</span><span class="token punctuation">(</span>memoryState<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">i8</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token constant">ALLOC_NORMAL</span>
<span class="token punctuation">)</span></code></pre></div>
<p>Above code will return a pointer of <code class="language-text">const char *</code> to the int array that represents a <code class="language-text">std::string</code> value. <code class="language-text">ALLOC_NORMAL</code> uses <code class="language-text">_malloc</code> under the hood, so it’s basically the same. There are five types of allocation:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token constant">ALLOC_NORMAL</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// Tries to use _malloc()</span>
<span class="token keyword">var</span> <span class="token constant">ALLOC_STACK</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Lives for the duration of the current function call</span>
<span class="token keyword">var</span> <span class="token constant">ALLOC_STATIC</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// Cannot be freed</span>
<span class="token keyword">var</span> <span class="token constant">ALLOC_DYNAMIC</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// Cannot be freed except through sbrk</span>
<span class="token keyword">var</span> <span class="token constant">ALLOC_NONE</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment">// Do not allocate</span></code></pre></div>
<p>But in most cases using just <code class="language-text">ALLOC_NORMAL</code> will suffice.</p>
<p>Anyway, after creating these pointers in Javascript, you can supply them as arguments to the wasm function:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> executionOutputCharPtr <span class="token operator">=</span> <span class="token function">_run_kite_once</span><span class="token punctuation">(</span>
  codeCharPtr<span class="token punctuation">,</span>
  memoryCharPtr<span class="token punctuation">,</span>
  registerCharPtr<span class="token punctuation">,</span>
  isDebugOnInt8Ptr<span class="token punctuation">,</span>
  isDataFwdOnInt8Ptr<span class="token punctuation">,</span>
  isBrPredOnInt8Ptr
<span class="token punctuation">)</span></code></pre></div>
<p>Note that this should exactly match the type definition of the equivalent function in C++:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token function">run_kite_once</span><span class="token punctuation">(</span>
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>program_code<span class="token punctuation">,</span> 
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>memory_state<span class="token punctuation">,</span> 
  <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>reg_state<span class="token punctuation">,</span>
  <span class="token keyword">int8_t</span> <span class="token operator">*</span>is_debug_on<span class="token punctuation">,</span>
  <span class="token keyword">int8_t</span> <span class="token operator">*</span>is_data_fwd_on<span class="token punctuation">,</span>
  <span class="token keyword">int8_t</span> <span class="token operator">*</span>is_br_pred_on
<span class="token punctuation">)</span></code></pre></div>
<p>The above code also explains how we convert build flags into runtime variables supplied from Javascript. The existing C++ code had many lines like this:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">DEBUG</span></span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ticks <span class="token operator">&lt;&lt;</span> <span class="token string">" : cache miss : addr = "</span> <span class="token operator">&lt;&lt;</span> addr
             <span class="token operator">&lt;&lt;</span> <span class="token string">" (tag = "</span> <span class="token operator">&lt;&lt;</span> tag <span class="token operator">&lt;&lt;</span> <span class="token string">", set = "</span> <span class="token operator">&lt;&lt;</span> set_index <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span></code></pre></div>
<p>So all I had to do was to convert that into:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">*</span>is_debug_on<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    program_log <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>ticks <span class="token operator">&lt;&lt;</span> <span class="token string">" : cache miss : addr = "</span> <span class="token operator">&lt;&lt;</span> addr
      <span class="token operator">&lt;&lt;</span> <span class="token string">" (tag = "</span> <span class="token operator">&lt;&lt;</span> tag <span class="token operator">&lt;&lt;</span> <span class="token string">", set = "</span> <span class="token operator">&lt;&lt;</span> set_index <span class="token operator">&lt;&lt;</span> <span class="token string">")"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>after getting <code class="language-text">is_debug_on</code> from <code class="language-text">run_kite_once</code>. No more <code class="language-text">make -j OPT=&quot;-DDEBUG&quot;</code> after changing the code like so.</p>
<h2 id="throwing-the-error-to-javascript" style="position:relative;">Throwing the error to Javascript<a href="#throwing-the-error-to-javascript" aria-label="throwing the error to javascript permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>The existing code handled an error like this:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp">    <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cerr <span class="token operator">&lt;&lt;</span> <span class="token string">"Error: number of sets must be a power of two"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre></div>
<p>Just <code class="language-text">cerr</code> and <code class="language-text">exit(1)</code>. But first problem was that <code class="language-text">cerr</code>, even if replaced by <code class="language-text">std::ostringstream&amp; program_log</code>, won’t emit the output properly probably due to immediate <code class="language-text">exit(1)</code> right below, which would throw a generic exception to Javascript without any specific error message. So above code would be converted like so:</p>
<div class="gatsby-highlight" data-language="cpp"><pre class="language-cpp"><code class="language-cpp"><span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> std<span class="token operator">::</span><span class="token function">logic_error</span><span class="token punctuation">(</span><span class="token string">"Cache Error: number of sets must be a power of two"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>Then, you can easily capture the error in Javascript like this:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">try</span> <span class="token punctuation">{</span>
  executionOutputCharPtr <span class="token operator">=</span> <span class="token function">_run_kite_once</span><span class="token punctuation">(</span>
    codeCharPtr<span class="token punctuation">,</span>
    memoryCharPtr<span class="token punctuation">,</span>
    registerCharPtr<span class="token punctuation">,</span>
    isDebugOnInt8Ptr<span class="token punctuation">,</span>
    isDataFwdOnInt8Ptr<span class="token punctuation">,</span>
    isBrPredOnInt8Ptr
  <span class="token punctuation">)</span>

  <span class="token keyword">const</span> executionOutputInJSString <span class="token operator">=</span> <span class="token function">UTF8ToString</span><span class="token punctuation">(</span>executionOutputCharPtr<span class="token punctuation">)</span>
  <span class="token function">setExecutionOutput</span><span class="token punctuation">(</span>executionOutputInJSString<span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token operator">:</span> any<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  errorPtr <span class="token operator">=</span> e <span class="token keyword">as</span> number
  executionOutputCharPtr <span class="token operator">=</span> <span class="token function">_get_exception_message</span><span class="token punctuation">(</span>errorPtr<span class="token punctuation">)</span>
  <span class="token function">setExecutionOutput</span><span class="token punctuation">(</span>
    <span class="token function">UTF8ToString</span><span class="token punctuation">(</span>executionOutputCharPtr<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
  <span class="token punctuation">;</span><span class="token punctuation">[</span>
    codeCharPtr<span class="token punctuation">,</span>
    memoryCharPtr<span class="token punctuation">,</span>
    registerCharPtr<span class="token punctuation">,</span>
    isDebugOnInt8Ptr<span class="token punctuation">,</span>
    isDataFwdOnInt8Ptr<span class="token punctuation">,</span>
    isBrPredOnInt8Ptr<span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>_free<span class="token punctuation">)</span>
  <span class="token punctuation">;</span><span class="token punctuation">[</span>executionOutputCharPtr<span class="token punctuation">,</span> errorPtr<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">ptr</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ptr<span class="token punctuation">)</span> <span class="token function">_free</span><span class="token punctuation">(</span>ptr<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">throw</code> from C++ would return a pointer to the error, and <code class="language-text">_get_exception_message</code> would convert that into a pointer of <code class="language-text">const char *</code>. Then we can convert that into a javascript string.</p>
<p>Additionally, you will have to free all pointers in <code class="language-text">finally</code>. Your wasm will have a memory leak if you don’t free them as you use the webapp.</p>
<h2 id="compilation-of-existing-c-into-webassembly" style="position:relative;">Compilation of existing C++ into Webassembly<a href="#compilation-of-existing-c-into-webassembly" aria-label="compilation of existing c into webassembly permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>So how do you export functions from C++? <a href="https://joel.is-a.dev/2022-05-10-How-to-compile-C++-code-into-Webassembly-with-Emscripten-and-use-it-in-Webpack-+-Typescript-+-React-project/">The basic walkthrough is extensively covered in my previous blog post</a>.</p>
<p>But, since the previous blog post is quite general, some more explanation may be needed for the specific context of this project.</p>
<p>First, I never wanted to install Emscripten (<code class="language-text">em++</code>) on my computer, so I used the official docker image. This is the contents of <code class="language-text">dockerfile</code>:</p>
<div class="gatsby-highlight" data-language="dockerfile"><pre class="language-dockerfile"><code class="language-dockerfile"><span class="token keyword">FROM</span> emscripten/emsdk<span class="token punctuation">:</span>latest

<span class="token keyword">WORKDIR</span> /etc/kite<span class="token punctuation">-</span>wasm

<span class="token keyword">RUN</span> ls <span class="token punctuation">-</span>la

<span class="token keyword">RUN</span> which em++

<span class="token keyword">ENTRYPOINT</span> <span class="token punctuation">[</span><span class="token string">"./compile.sh"</span><span class="token punctuation">]</span></code></pre></div>
<p>Does nothing but running a few checks, setting the workdir and <code class="language-text">compile.sh</code> script.</p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

em++ -O3 -s <span class="token assign-left variable">WASM</span><span class="token operator">=</span><span class="token number">1</span> -s <span class="token assign-left variable">EXPORTED_RUNTIME_METHODS</span><span class="token operator">=</span><span class="token string">'["cwrap", "allocate", "intArrayFromString", "ALLOC_NORMAL", "UTF8ToString", "setValue"]'</span> -s <span class="token assign-left variable">ALLOW_MEMORY_GROWTH</span><span class="token operator">=</span><span class="token number">1</span> -s <span class="token assign-left variable">MODULARIZE</span><span class="token operator">=</span><span class="token number">1</span> -s <span class="token string">'EXPORT_NAME="kite"'</span> -s <span class="token string">'EXPORTED_FUNCTIONS=["_run_kite_once", "_free", "_get_exception_message"]'</span> -s <span class="token string">"ENVIRONMENT='web'"</span> -o ./kite_wasm.js kite_wasm.cc alu.cc br_predictor.cc data_cache.cc data_memory.cc inst_memory.cc inst.cc pipe_reg.cc proc.cc reg_file.cc</code></pre></div>
<p>Now, above is the <code class="language-text">compile.sh</code> script. The functions we use from Webassembly will need to be exported using <code class="language-text">EXPORTED_RUNTIME_METHODS</code> and <code class="language-text">EXPORTED_FUNCTIONS</code>. The former is for exporting a runtime method, and the latter is for exporting compiled code. But I honestly don’t know why <code class="language-text">_free</code> must be in <code class="language-text">EXPORTED_FUNCTIONS</code> and not <code class="language-text">EXPORTED_RUNTIME_METHODS</code>.</p>
<p><code class="language-text">-o ./kite_wasm.js kite_wasm.cc ...</code> is also important; If you don’t place the file that contains <code class="language-text">extern &quot;C&quot;</code> first, <code class="language-text">em++</code> will not work as intended. For example, if you do <code class="language-text">-o ./kite_wasm.js alu.cc kite_wasm.cc ...</code>, you will fail to export your functions you want to.</p>
<p>I also didn’t want to copy and paste, or try to remember docker command I use like I do every day, so I just wrote this util:</p>
<p><em>dockerutil.sh</em></p>
<div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">while</span> <span class="token builtin class-name">getopts</span> c: flag<span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token keyword">case</span> <span class="token string">"<span class="token variable">${flag}</span>"</span> <span class="token keyword">in</span>
    c<span class="token punctuation">)</span>
        <span class="token keyword">case</span> <span class="token string">"<span class="token variable">${OPTARG}</span>"</span> <span class="token keyword">in</span>
        build<span class="token punctuation">)</span>
            docker build <span class="token builtin class-name">.</span> -t kite-wasm
            <span class="token punctuation">;</span><span class="token punctuation">;</span>

        run<span class="token punctuation">)</span>
            docker run --rm -v <span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">pwd</span><span class="token variable">)</span></span>:/etc/kite-wasm kite-wasm 
            <span class="token punctuation">;</span><span class="token punctuation">;</span>

        *<span class="token punctuation">)</span>
            <span class="token builtin class-name">echo</span> <span class="token string">"dockerutil.sh -c run|build"</span>
            <span class="token builtin class-name">exit</span> 
            <span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token keyword">esac</span>

        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span> 
        <span class="token builtin class-name">echo</span> <span class="token string">"dockerutil.sh -c run|build"</span>
        <span class="token builtin class-name">exit</span> 
        <span class="token punctuation">;</span><span class="token punctuation">;</span>
    <span class="token keyword">esac</span>
<span class="token keyword">done</span></code></pre></div>
<p>So I would just run <code class="language-text">./dockerutil.sh -c run</code> or <code class="language-text">./dockerutil.sh -c build</code> and that’s it.</p>
<p>Now I just need to <code class="language-text">./dockerutil.sh -c build</code> for the first time to build the image, and <code class="language-text">./dockerutil.sh -c run</code>.</p>
<p>Then two files will be created: <code class="language-text">kite_wasm.js</code> and <code class="language-text">kite_wasm.wasm</code>. Since I am using Webpack for my React project, I would need some glue code like below (<a href="https://joel.is-a.dev/2022-05-10-How-to-compile-C++-code-into-Webassembly-with-Emscripten-and-use-it-in-Webpack-+-Typescript-+-React-project/">more details on this in my previous post</a>):</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> kite <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./kite_wasm.js"</span>
<span class="token keyword">import</span> kiteModule <span class="token keyword">from</span> <span class="token string">"./kite_wasm.wasm"</span>

<span class="token comment">// Since webpack will change the name and potentially the path of the</span>
<span class="token comment">// `.wasm` file, we have to provide a `locateFile()` hook to redirect</span>
<span class="token comment">// to the appropriate URL.</span>
<span class="token comment">// More details: https://kripken.github.io/emscripten-site/docs/api_reference/module.html</span>
<span class="token keyword">const</span> wasm <span class="token operator">=</span> <span class="token function">kite</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">locateFile</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.wasm</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> kiteModule
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> path
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> wasm</code></pre></div>
<p>And then import and load Webassembly as follows:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts">    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">loadKiteWasm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">[</span>err<span class="token punctuation">,</span> wasm<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">tcAsync</span><span class="token punctuation">(</span>KiteWasmPromise<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err <span class="token operator">&amp;&amp;</span> wasm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          kiteWasmRequestResult<span class="token punctuation">.</span>current <span class="token operator">=</span> wasm
          <span class="token function">setWasmRequestStatus</span><span class="token punctuation">(</span>WasmRequestStatus<span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          kiteWasmRequestResult<span class="token punctuation">.</span>current <span class="token operator">=</span> err
          <span class="token function">setWasmRequestStatus</span><span class="token punctuation">(</span>WasmRequestStatus<span class="token punctuation">.</span><span class="token constant">ERROR</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">loadKiteWasm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre></div>
<p>Then somewhere later in the code you would run</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">kiteWasmRequestResult<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">_run_kite_once</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span></code></pre></div>
<p>!</p>
<p>So that is how I built my latest project.</p>
<h2 id="reflections--implications" style="position:relative;">Reflections &#x26; implications<a href="#reflections--implications" aria-label="reflections  implications permalink" class="anchor after"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a></h2>
<p>Some little thoughts after the completion of the project:</p>
<ol>
<li>While <a href="https://emscripten.org/">Emscripten</a> is the de facto #1 tool to compile C++ to Webassembly, it is still quite poorly documented. Perhaps I will make some PRs to improve the docs. I initially struggled to find insightful docs to use stuffs like <code class="language-text">_allocate</code> or <code class="language-text">ALLOC_NORMAL</code>. In the end, I managed to find some other blog posts that explain them instead.</li>
<li>If you overcome all hurdles, it becomes extremely easy to port C++ code to webassembly from then on.</li>
<li>It’s unavoidable that you understand and change some parts of the existing C++ code to be able to export functions to Webassembly. If this becomes your product’s workflow, this may become a bit inconvenient, because a developer may have to think about how a change to the code will affect webassembly as he/she codes. Practically, your code may require lots of changes if it would be used for functionalities specific to Web APIs, like Canvas (props to <a href="https://www.figma.com/blog/webassembly-cut-figmas-load-time-by-3x/">the Figma team</a> and teams of other similar products using Wasm &#x26; Canvas)</li>
<li>It’s not true anymore that frontend engineering only relates to high-level programming. Things have changed over the past few years. You now have stuffs like <code class="language-text">Uint8Array</code> as well as entire wasm support on the browser (and node.js). A well-disciplined FE engineer will be able to take care of all these.</li>
</ol></div><hr style="margin-bottom:1.75rem"/><div style="display:flex"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDAf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABy7nSMycNUI5yDf/EABoQAQEAAwEBAAAAAAAAAAAAAAECAAMSBBH/2gAIAQEAAQUCKcJEdM/YiqC5hvZ3XqtNnSDn/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ASv/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8BI//EACAQAAIBAwQDAAAAAAAAAAAAAAABAhExQRASISJRUmH/2gAIAQEABj8CpQcZXOz2vwVdj57DkxwXEY4Glm+n/8QAGxAAAgMBAQEAAAAAAAAAAAAAAAERITFBYYH/2gAIAQEAAT8hgUw8H+KVqHQvZJwmVzhuN3ufBm5YyHgQkhCf6Gg//9oADAMBAAIAAwAAABAQKHz/xAAYEQACAwAAAAAAAAAAAAAAAAAAARARUf/aAAgBAwEBPxBIrk//xAAZEQADAAMAAAAAAAAAAAAAAAAAAREQIVH/2gAIAQIBAT8Qbmi+ix//xAAdEAEAAgIDAQEAAAAAAAAAAAABABEhMUFRYXHB/9oACAEBAAE/EG07OyWDzfUTIQvQcUBt9YkDm7GPYqTeWIPe/wBmi62AQwsVa+YlES9/DggPKdTCvL2xUW0HqIqGsT//2Q==" alt="Joel Mun" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/1265356b9e6bab3ff8ccafeaca6d96b8/99438/profile-pic.jpg 1x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/aba1d/profile-pic.jpg 1.5x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/b315d/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/1265356b9e6bab3ff8ccafeaca6d96b8/99438/profile-pic.jpg 1x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/aba1d/profile-pic.jpg 1.5x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/b315d/profile-pic.jpg 2x" src="/static/1265356b9e6bab3ff8ccafeaca6d96b8/99438/profile-pic.jpg" alt="Joel Mun" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p style="color:#E0E0E0">Written by <strong>Joel Mun</strong>. Joel likes GoLang, Typescript, React, Node.js, Python, Wasm and more. Equipped with a set of diverse skills, He&#x27;s been working as a lead SWE for some length of time. He also loves to enlarge the boundaries of his knowledge, mainly by reading books and watching lectures on Youtube. Guitar and piano are necessities at his house.<!-- --> <div style="margin-top:10px"></div><a style="box-shadow:none;margin-right:8px" href="https://github.com/9oelM" target="_blank" rel="noopener noreferer"><svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 24 24" fill="#E0E0E0"><path d="M0 0v24h24v-24h-24zm14.534 19.59c-.406.078-.534-.171-.534-.384v-2.195c0-.747-.262-1.233-.55-1.481 1.782-.198 3.654-.875 3.654-3.947 0-.874-.311-1.588-.824-2.147.083-.202.357-1.016-.079-2.117 0 0-.671-.215-2.198.82-.639-.18-1.323-.267-2.003-.271-.68.003-1.364.091-2.003.269-1.528-1.035-2.2-.82-2.2-.82-.434 1.102-.16 1.915-.077 2.118-.512.56-.824 1.273-.824 2.147 0 3.064 1.867 3.751 3.645 3.954-.229.2-.436.552-.508 1.07-.457.204-1.614.557-2.328-.666 0 0-.423-.768-1.227-.825 0 0-.78-.01-.055.487 0 0 .525.246.889 1.17 0 0 .463 1.428 2.688.944v1.489c0 .211-.129.459-.528.385-3.18-1.057-5.472-4.056-5.472-7.59 0-4.419 3.582-8 8-8s8 3.581 8 8c0 3.533-2.289 6.531-5.466 7.59z"></path></svg></a><a style="box-shadow:none;margin-right:8px" href="https://www.linkedin.com/in/7oelm/" target="_blank" rel="noopener noreferer"><svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" viewBox="0 0 24 24" fill="#E0E0E0"><path d="M0 0v24h24v-24h-24zm8 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.397-2.586 7-2.777 7 2.476v6.759z"></path></svg></a><a style="box-shadow:none;margin-right:8px" href="https://hackerone.com/9oelm" target="_blank" rel="noopener noreferer"><svg xmlns="http://www.w3.org/2000/svg" width="29" height="29" aria-label="HackerOne" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#E0E0E0"></rect><path d="M174 56c-10 1-23 5-25 16v367c2 9 11 15 20 16h14c9-2 20-7 21-17a116708 116708 0 0 0 0-366c-3-11-15-15-25-16h-5zM333 200c-7 1-13 2-17 5l-74 47c-4 3-5 8-5 12 2 12 8 21 17 27 7 4 18 7 25 2l29-19v165c3 10 12 15 21 17h10c9-2 19-5 23-14l1-3a18494 18494 0 0 0 0-222c-1-12-16-16-26-17h-4z"></path></svg></a><a style="box-shadow:none;margin-right:8px" href="https://bugcrowd.com/9oelm" target="_blank" rel="noopener noreferer"><svg width="29" height="29" viewBox="0 0 24 24" role="img" fill="#E0E0E0"><path d="M24 12 18 1.387H6L0 12l6 10.613h12zm-5.782 1.658c-.003.825-.122 1.569-.354 2.231a5.05 5.05 0 0 1-.99 1.708 4.316 4.316 0 0 1-1.503 1.093 4.69 4.69 0 0 1-1.896.385 4.158 4.158 0 0 1-1.145-.152 3.754 3.754 0 0 1-.868-.36 3.792 3.792 0 0 1-.601-.435 3.023 3.023 0 0 1-.466-.514h-.04l.02.193c.011.166.018.331.02.497v.528H7.961V7.062c0-.151-.04-.263-.114-.337-.077-.074-.19-.109-.33-.109h-.811V4.425h2.452c.473-.003.824.108 1.048.331.222.223.333.576.33 1.049v3.003c-.003.258-.01.467-.02.626l-.02.247h.04a2.898 2.898 0 0 1 .463-.507c.156-.143.354-.284.6-.426.245-.142.538-.261.876-.36.38-.1.77-.15 1.162-.148.702.003 1.334.135 1.894.395a4.118 4.118 0 0 1 1.446 1.11c.4.48.707 1.052.92 1.715.212.658.317 1.392.32 2.198m-2.803 1.406c.138-.399.206-.852.209-1.366-.003-.659-.112-1.231-.328-1.718-.216-.484-.517-.859-.902-1.125a2.347 2.347 0 0 0-1.344-.404 2.57 2.57 0 0 0-.969.186 2.372 2.372 0 0 0-.83.589 2.839 2.839 0 0 0-.579 1.015c-.141.413-.212.906-.216 1.477 0 .397.053.792.159 1.174.101.366.265.712.483 1.02.211.3.486.548.805.722.32.176.698.267 1.127.27.343.002.683-.07.997-.213a2.43 2.43 0 0 0 .824-.623c.24-.273.428-.607.564-1.004z"></path></svg></a><a style="box-shadow:none;margin-right:8px" href="https://medium.com/@9oelm" target="_blank" rel="noopener noreferer"><svg width="29" height="29" xmlns="http://www.w3.org/2000/svg" fill="#E0E0E0" viewBox="0 0 24 24" fill-rule="evenodd" clip-rule="evenodd"><path d="M24 24h-24v-24h24v24zm-4.03-5.649v-.269l-1.247-1.224c-.11-.084-.165-.222-.142-.359v-8.998c-.023-.137.032-.275.142-.359l1.277-1.224v-.269h-4.422l-3.152 7.863-3.586-7.863h-4.638v.269l1.494 1.799c.146.133.221.327.201.523v7.072c.044.255-.037.516-.216.702l-1.681 2.038v.269h4.766v-.269l-1.681-2.038c-.181-.186-.266-.445-.232-.702v-6.116l4.183 9.125h.486l3.593-9.125v7.273c0 .194 0 .232-.127.359l-1.292 1.254v.269h6.274z"></path></svg></a></p></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;color:#E0E0E0"><li style="color:#E0E0E0"><a rel="prev" href="/2022-05-10-How-to-compile-C++-code-into-Webassembly-with-Emscripten-and-use-it-in-Webpack-+-Typescript-+-React-project/">← <!-- -->How to compile C++ code into Webassembly with Emscripten + Docker and use it in Webpack + Typescript + React project</a></li><li style="color:#E0E0E0"></li></ul><div id="disqus_thread" identifier="b09d3759-2caf-5842-81fc-184dc931a75e" title="Practical Emscripten &amp; Webassembly: Simple RISC-V Simulator on the web" url="https://9oelm.github.io/2022-05-13-RISC-V-Simulator-On-The-Web/"></div></main><footer style="background-color:#212121;color:#E0E0E0;margin-top:3.5rem">© Joel Mun <!-- -->2022</footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-105275697-3', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022-05-13-RISC-V-Simulator-On-The-Web/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-d0a90a918e39f7bd0bdc.js"],"app":["/app-a9a1b482fc219c8dbb62.js"],"component---src-pages-404-js":["/component---src-pages-404-js-105a40134fca1ebb41a4.js"],"component---src-pages-index-js":["/component---src-pages-index-js-f7fc9258e2b7a66caf3f.js"],"component---src-pages-journals-js":["/component---src-pages-journals-js-263afdbfa36e616db66f.js"],"component---src-pages-tags-js":["/component---src-pages-tags-js-b5637851e3765cbc34d8.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-8daac0a110424eb1ce6c.js"],"component---src-templates-tags-js":["/component---src-templates-tags-js-987002a6e898aa1dfd57.js"]};/*]]>*/</script><script src="/polyfill-d0a90a918e39f7bd0bdc.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-8daac0a110424eb1ce6c.js" async=""></script><script src="/3aff51721f55eece1e790a7bf464ea83c5b17b16-8f5aee00595b7b0ef6e1.js" async=""></script><script src="/commons-0f15d263951f172ebd0e.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-a9a1b482fc219c8dbb62.js" async=""></script><script src="/framework-58f863d6aa18c11a521f.js" async=""></script><script src="/webpack-runtime-1c1502302e7410b95bca.js" async=""></script></body></html>