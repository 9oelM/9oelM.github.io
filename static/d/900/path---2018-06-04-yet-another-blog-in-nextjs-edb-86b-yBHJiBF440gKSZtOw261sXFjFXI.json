{"data":{"site":{"siteMetadata":{"title":"Joel's dev blog","author":"Joel Mun","siteUrl":"https://9oelm.github.io"}},"markdownRemark":{"id":"eb10853e-b7e8-51a4-8888-625462e321b9","excerpt":"Set up basic things ( see previous post on basic things with next.js ) Install next, react, react-dom & grommet command line tools and grommet Create   inside…","html":"<h2>Set up basic things (<a href=\"https://9oelm.github.io/development/2018/06/01/Next.js-(1)-Basic-setup-and-understanding.html\">see previous post on basic things with next.js</a>)</h2>\n<h3>Install next, react, react-dom &#x26; grommet command line tools and grommet</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm init\n\nnpm install --save next react react-dom\n\nnpm install --save grommet</code></pre></div>\n<h3>Create <code class=\"language-text\">_document.js</code> inside <code class=\"language-text\">pages</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">j031:~/workspace $ tree -L 2 -I node_modules\n.\n├── README.md\n├── package.json\n└── pages\n    └── _document.js</code></pre></div>\n<p>Why <code class=\"language-text\">_document.js</code>? </p>\n<blockquote>\n<p>Pages in Next.js skip the definition of the surrounding document’s markup. For example, you never include <html>, <body>, etc. <strong>To override that default behavior, you must create a file at ./pages/_document.js</strong>, where you can extend the Document class.</p>\n</blockquote>\n<p><code class=\"language-text\">_document.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// pages/_document.js</span>\n<span class=\"token keyword\">import</span> Document<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Head<span class=\"token punctuation\">,</span> Main<span class=\"token punctuation\">,</span> NextScript <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/document'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomDocument</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Document</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Head<span class=\"token operator\">></span>\n        <span class=\"token comment\">/* This is going to be your global head */</span>\n          <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Head<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>Main <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token comment\">/* each routed page will go inside here */</span>\n          <span class=\"token operator\">&lt;</span>NextScript <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token comment\">/* You don't have to care about this. */</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3>Make <code class=\"language-text\">pages/index.js</code></h3>\n<p><code class=\"language-text\">index.js</code> will be <code class=\"language-text\">/</code> if you were entering the website with an URL.</p>\n<h3>Make <code class=\"language-text\">pages/_error.js</code></h3>\n<p>This page will be shown if there is an error. This is a custom error page. </p>\n<h3>Make <code class=\"language-text\">/next.config.js</code></h3>\n<p>This is going to contain your settings.</p>\n<h3>Make <code class=\"language-text\">components</code> folder and put components inside it.</h3>\n<h3>Make <code class=\"language-text\">static</code> folder and put static assets inside it.</h3>\n<h2>So far</h2>\n<p>Directory structure</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">j031:~/workspace $ tree -L 2 -I node_modules                                                                                   \n.\n├── README.md\n├── components\n├── next.config.js\n├── package.json\n└── pages\n    ├── _document.js\n    ├── _error.js\n    └── index.js\n    \n+ node_modules ofc</code></pre></div>\n<h3>Include CSS</h3>\n<p>I’m using sass.</p>\n<p>First, get the loader for sass (<code class=\"language-text\">node-sass</code> is a peer)</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save @zeit/next-sass node-sass</code></pre></div>\n<p>And edit <code class=\"language-text\">next.config.js</code> to apply the changes</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> withSass <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@zeit/next-sass'</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">withSass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">webpack</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Further custom configuration here</span>\n    <span class=\"token keyword\">return</span> config\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<blockquote>\n<p>The stylesheet is compiled to .next/static/style.css. You have to include it into the page using a custom <em>document.js. The file will be served from **`/</em>next/static/style.css`**</p>\n</blockquote>\n<p>There will be only one stylesheet (<code class=\"language-text\">/_next/static/style.css</code>)in the end no matter how many stylesheets you import inside <code class=\"language-text\">/pages</code>. </p>\n<h2>Darn it. it’s hard. I got it launched up finally:</h2>\n<p><img src=\"https://i.imgur.com/t5EFRrR.jpg\" alt=\"Website launched\"></p>\n<h2>And this is what we’ve got so far:</h2>\n<h3>Structure</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">j031:~/workspace $ tree -L 2 -I node_modules                                    \n.\n├── README.md\n├── components\n├── next.config.js\n├── npm-debug.log\n├── package.json\n├── pages\n│   ├── _document.js\n│   ├── _error.js\n│   └── index.js\n└── static\n    └── styles.scss\n\n3 directories, 8 files</code></pre></div>\n<h3><code class=\"language-text\">/next.config.js</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> withSass <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@zeit/next-sass'</span><span class=\"token punctuation\">)</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">withSass</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">webpack</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Further custom configuration here</span>\n    <span class=\"token keyword\">return</span> config\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3><code class=\"language-text\">/pages/_document.js</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// _document.js</span>\n<span class=\"token comment\">// pages/_document.js</span>\n<span class=\"token keyword\">import</span> Document<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Head<span class=\"token punctuation\">,</span> Main<span class=\"token punctuation\">,</span> NextScript <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/document'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomDocument</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Document</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Head<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span><span class=\"token comment\">/* This is going to be your global head */</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token string\">\"stylesheet\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"/_next/static/style.css\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Head<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>Main <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* each routed page will go inside here */</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>NextScript <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* You don't have to care about this. */</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3><code class=\"language-text\">/pages/_error.js</code></h3>\n<p>run </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save isomorphic-unfetch</code></pre></div>\n<p>to get the dependency first.</p>\n<p>then</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> Error <span class=\"token keyword\">from</span> <span class=\"token string\">'next/error'</span>\n<span class=\"token keyword\">import</span> fetch <span class=\"token keyword\">from</span> <span class=\"token string\">'isomorphic-unfetch'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Page</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> <span class=\"token keyword\">async</span> <span class=\"token function\">getInitialProps</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'https://api.github.com/repos/zeit/next.js'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> statusCode <span class=\"token operator\">=</span> res<span class=\"token punctuation\">.</span>statusCode <span class=\"token operator\">></span> <span class=\"token number\">200</span> <span class=\"token operator\">?</span> res<span class=\"token punctuation\">.</span>statusCode <span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token keyword\">const</span> json <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> statusCode<span class=\"token punctuation\">,</span> stars<span class=\"token punctuation\">:</span> json<span class=\"token punctuation\">.</span>stargazers_count <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>statusCode<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Error statusCode<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>statusCode<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        Next stars<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>stars<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h3><code class=\"language-text\">/pages/index.js</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"../static/styles.scss\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"example\"</span><span class=\"token operator\">></span>Hello World<span class=\"token operator\">!</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></code></pre></div>\n<h3><code class=\"language-text\">/static/styles.scss</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\">$<span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 50px<span class=\"token selector\">;\n.example</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> $font-size<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Why are the styles not being applied?</h2>\n<p>This was my <code class=\"language-text\">index.js</code> and the styles for the website were not being applied. I did not know why. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/layout\"</span>\n<span class=\"token keyword\">import</span> Card <span class=\"token keyword\">from</span> <span class=\"token string\">'grommet/components/Card'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Layout<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Card thumbnail<span class=\"token operator\">=</span><span class=\"token string\">'http://grommet.io/img/carousel-1.png'</span>\n          label<span class=\"token operator\">=</span><span class=\"token string\">'Sample Label'</span>\n          heading<span class=\"token operator\">=</span><span class=\"token string\">'Sample Heading'</span>\n          description<span class=\"token operator\">=</span><span class=\"token string\">'Sample description providing more details.'</span>\n           <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Layout<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>After a tiring length of search for the answer on Google, I found the <a href=\"https://github.com/grommet/grommet/issues/640\">answer</a>: <code class=\"language-text\">&lt;Grommet.App&gt;</code>.</p>\n<p>I needed to wrap the components inside <code class=\"language-text\">&lt;Grommet.App&gt;</code>. It was that simple.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> Layout <span class=\"token keyword\">from</span> <span class=\"token string\">\"../components/layout\"</span>\n<span class=\"token keyword\">import</span> Card <span class=\"token keyword\">from</span> <span class=\"token string\">'grommet/components/Card'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Grommet <span class=\"token keyword\">from</span> <span class=\"token string\">'grommet'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>Grommet<span class=\"token punctuation\">.</span>App<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Layout<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Card thumbnail<span class=\"token operator\">=</span><span class=\"token string\">'http://grommet.io/img/carousel-1.png'</span>\n          label<span class=\"token operator\">=</span><span class=\"token string\">'Sample Label'</span>\n          heading<span class=\"token operator\">=</span><span class=\"token string\">'Sample Heading'</span>\n          description<span class=\"token operator\">=</span><span class=\"token string\">'Sample description providing more details.'</span>\n           <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Layout<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Grommet<span class=\"token punctuation\">.</span>App<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<p>And now the styling works. And also, you need to add the core element cdn to make styling work:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// _document.js</span>\n<span class=\"token keyword\">import</span> Document<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Head<span class=\"token punctuation\">,</span> Main<span class=\"token punctuation\">,</span> NextScript <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/document'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomDocument</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Document</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Head<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span><span class=\"token comment\">/* This is going to be your global head */</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>link rel<span class=\"token operator\">=</span><span class=\"token string\">\"stylesheet\"</span> href<span class=\"token operator\">=</span><span class=\"token string\">\"https://cdnjs.cloudflare.com/ajax/libs/grommet/1.10.1/grommet.min.css\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>script src <span class=\"token operator\">=</span> <span class=\"token string\">\"https://cdnjs.cloudflare.com/ajax/libs/grommet/1.10.1/grommet.min.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Head<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>Main <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* each routed page will go inside here */</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>NextScript <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* You don't have to care about this. */</span><span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>Troubleshooting</h2>\n<p>Now I had to convert the theme of the blog to <code class=\"language-text\">dxc</code>. To do that I had to <code class=\"language-text\">import &quot;grommet/grommet-dxc.min.css&quot;;</code> But this kept throwing me an error:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> ERROR  Failed to compile with 1 errors                                                                                                                                                     10:12:43 AM\n\n error  in ./node_modules/grommet/grommet-dxc.min.css\n\nModule parse failed: Unexpected character &#39;@&#39; (5:3)\nYou may need an appropriate loader to handle this file type.\n|  *\n|  * github.com/inuitcss | inuitcss.com\n|  */@-webkit-keyframes fadein{from{opacity:0}to{opacity:1}}@keyframes fadein{from{opacity:0}to{opacity:1}}/*!\n|  * inuitcss, by @csswizardry\n|  *</code></pre></div>\n<p>Webpack does not support css loaders by default so you have to install it.</p>\n<p>And a few searches revealed to me that this is a webpack config problem.</p>\n<p>Ok so <a href=\"https://webpack.js.org/concepts/#loaders\">webpack.js.org says:</a></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//At a high level, loaders have two purposes in your webpack configuration:</span>\n\n<span class=\"token comment\">//The test property identifies which file or files should be transformed.</span>\n<span class=\"token comment\">//The use property indicates which loader should be used to do the transforming.</span>\n\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    filename<span class=\"token punctuation\">:</span> <span class=\"token string\">'my-first-webpack.bundle.js'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  module<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    rules<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span> test<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\.txt$/</span><span class=\"token punctuation\">,</span> use<span class=\"token punctuation\">:</span> <span class=\"token string\">'raw-loader'</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> config<span class=\"token punctuation\">;</span></code></pre></div>\n<p>So I went ahead to make few changes:</p>\n<p><code class=\"language-text\">/static/styles.scss</code></p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@import</span> <span class=\"token string\">\"grommet/grommet-dxc.min.css\"</span><span class=\"token punctuation\">;</span></span></code></pre></div>\n<p><code class=\"language-text\">next.config.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> withCss <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@zeit/next-css'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">withCss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token comment\">/* extra optional config */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>And now the website works.</p>\n<h3>Before</h3>\n<p><img src=\"https://i.imgur.com/KpUR0E7.jpg\" alt=\"Before\"></p>\n<h3>After</h3>\n<p><img src=\"https://i.imgur.com/u5OGkIM.jpg\" alt=\"After\"></p>\n<h2>Error</h2>\n<p>I kept getting this error, greatly increasing the loading speed for the website:</p>\n<p>Now the website looks like this right now</p>\n<p><img src=\"https://i.imgur.com/XmhDPcL.png\" alt=\"Website now\"></p>\n<p>But it keeps throwing me an error. </p>\n<p>Everything loads perfectly except in regards to speed.</p>\n<p>So the error from the console is this one:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span> Uncaught ReferenceError<span class=\"token punctuation\">:</span> React is not defined\n    at Object<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>anonymous<span class=\"token operator\">></span> <span class=\"token punctuation\">(</span>grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    at <span class=\"token function\">t</span> <span class=\"token punctuation\">(</span>grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    at Object<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>anonymous<span class=\"token operator\">></span> <span class=\"token punctuation\">(</span>grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span>\n    at <span class=\"token function\">t</span> <span class=\"token punctuation\">(</span>grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    at Object<span class=\"token punctuation\">.</span><span class=\"token operator\">&lt;</span>anonymous<span class=\"token operator\">></span> <span class=\"token punctuation\">(</span>grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    at <span class=\"token function\">t</span> <span class=\"token punctuation\">(</span>grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    at grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span>\n    at grommet<span class=\"token punctuation\">.</span>min<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">:</span><span class=\"token number\">1</span></code></pre></div>\n<p>and I found that this is related to.. either <code class=\"language-text\">import</code> or webpack:</p>\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/32070303/uncaught-referenceerror-react-is-not-defined\">might be webpack</a></li>\n<li><a href=\"https://teamtreehouse.com/community/solved-uncaught-reference-error-react-not-defined\">might be import problem</a></li>\n</ul>\n<p>And I think this link might help as well:</p>\n<ul>\n<li><a href=\"https://github.com/zeit/next.js/issues/1465\">github: importing jQuery in nextjs</a></li>\n<li><a href=\"https://github.com/grommet/next-sample\">github grommet sample</a></li>\n</ul>\n<p>These are the things that I have done to solve the problem:</p>\n<ol>\n<li>Check if all <code class=\"language-text\">.js</code> files that use <code class=\"language-text\">react</code> have <code class=\"language-text\">import</code> statements. </li>\n<li>Search more…</li>\n</ol>\n<p>And I found this:</p>\n<ol>\n<li>I was referring to <code class=\"language-text\">grommet.min.js</code> from a CDN. </li>\n<li>And this was not right, as this source was referring to <code class=\"language-text\">React</code> while it was just put inside <code class=\"language-text\">&lt;head&gt;</code> tag. It could not refer to <code class=\"language-text\">React</code>. </li>\n<li>So I did this to <code class=\"language-text\">_document.js</code>:</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> ReactDOM <span class=\"token keyword\">from</span> <span class=\"token string\">\"react-dom\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Document<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Head<span class=\"token punctuation\">,</span> Main<span class=\"token punctuation\">,</span> NextScript <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'next/document'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"../static/grommet-dxc.min.css\"</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"../static/style.css\"</span>\n<span class=\"token keyword\">import</span> Grommet <span class=\"token keyword\">from</span> <span class=\"token string\">\"grommet\"</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomDocument</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Document</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>html<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Head<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span><span class=\"token comment\">/* This is going to be your global head */</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>link rel <span class=\"token operator\">=</span> <span class=\"token string\">\"stylesheet\"</span> href <span class=\"token operator\">=</span> <span class=\"token string\">\"/_next/static/style.css\"</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>meta name<span class=\"token operator\">=</span><span class=\"token string\">\"viewport\"</span> content<span class=\"token operator\">=</span><span class=\"token string\">\"width=device-width, initial-scale=1\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>link href<span class=\"token operator\">=</span><span class=\"token string\">\"https://fonts.googleapis.com/css?family=Work+Sans:300,400,700\"</span> rel<span class=\"token operator\">=</span><span class=\"token string\">\"stylesheet\"</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>script src <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>Grommet<span class=\"token punctuation\">.</span>grommetux<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Head<span class=\"token operator\">></span>\n        \n        <span class=\"token operator\">&lt;</span>body<span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>Main <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* each routed page will go inside here */</span><span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>NextScript <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span><span class=\"token comment\">/* You don't have to care about this. */</span><span class=\"token punctuation\">}</span>\n          \n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>body<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>html<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now the project runs perfectly without the reference error!</p>\n<h2>Another error</h2>\n<p>Another one was this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">warning.js:33 Warning: Expected server HTML to contain a matching &lt;a&gt; in &lt;article&gt;.</code></pre></div>\n<p>well, this one…</p>\n<p>I found on github that this is just a warning and it does not show up on actualy production. So I ran the production server:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">next build\nnext start -p 8080 # c9.io only supports port 8080 for node.js</code></pre></div>\n<p>and no error happened. So all errors have been solved.</p>\n<h2>Another error after I installed eslint</h2>\n<p><a href=\"https://stackoverflow.com/questions/46840646/eslint-complaining-about-getinitialprops\">Solution on stackoverflow</a></p>\n<p>All things set correctly, I still got an error on <code class=\"language-text\">getInitialProps</code> when I ran eslint:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">/home/ubuntu/workspace/pages/_error.js\n  6:16  error  Parsing error: Unexpected token getInitialProps\n\n✖ 1 problem (1 error, 0 warnings)</code></pre></div>\n<p>And so I installed <code class=\"language-text\">babel-eslint</code> and added this line in <code class=\"language-text\">.eslintrc.json</code>: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;parser&quot;: &quot;babel-eslint&quot;,</code></pre></div>\n<p>and it complained no more. </p>\n<h2>Adding eslint to webpack</h2>\n<p>There’s an <a href=\"https://github.com/webpack-contrib/eslint-loader\"><code class=\"language-text\">eslint-loader</code></a> for webpack.</p>\n<p>First, install eslint:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install eslint --save-dev</code></pre></div>\n<p>then eslint-loader:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install eslint-loader --save-dev</code></pre></div>\n<h3>Reference</h3>\n<p>look at <a href=\"https://github.com/zeit/next.js/issues/2184\">this issue on github</a>.\nOne of the replies to the issue provided the code!</p>\n<h3>Use the code in <code class=\"language-text\">next.config.js</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> withCss <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@zeit/next-css'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">//  just in case if you use css</span>\n<span class=\"token keyword\">const</span> withSass <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'@zeit/next-sass'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> webpack <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>assocPath<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ramda'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">withSass</span><span class=\"token punctuation\">(</span><span class=\"token function\">withCss</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> \n    webpack<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> dev <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> eslintRule <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      test<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\.js$/</span><span class=\"token punctuation\">,</span>\n      enforce<span class=\"token punctuation\">:</span> <span class=\"token string\">'pre'</span><span class=\"token punctuation\">,</span>\n      exclude<span class=\"token punctuation\">:</span> <span class=\"token regex\">/node_modules/</span><span class=\"token punctuation\">,</span>\n      loader<span class=\"token punctuation\">:</span> <span class=\"token string\">'eslint-loader'</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// Emit errors as warnings for dev to not break webpack build.</span>\n        <span class=\"token comment\">// Eslint errors are shown in console for dev, yay :-)</span>\n        emitWarning<span class=\"token punctuation\">:</span> dev<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">const</span> rules <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">concat</span><span class=\"token punctuation\">(</span>eslintRule<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">.</span>rules<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token function\">assocPath</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'module'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rules'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> rules<span class=\"token punctuation\">,</span> config<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>and before that, since the code uses <code class=\"language-text\">ramda</code>, install it:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save-dev ramda</code></pre></div>\n<p>Then run <code class=\"language-text\">npm dev run</code>. Then you see the output from eslint:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">j031:~/workspace (add1-eslint) $ npm run dev\n\n&gt; young-blog@1.0.0 dev /home/ubuntu/workspace\n&gt; next -p 8080\n\n\n\n WARNING  Compiled with 2 warnings                                                                                                                                                                                              3:32:08 AM\n\n\n/home/ubuntu/workspace/pages/_document.js\n   1:8   error  &#39;React&#39; is defined but never used                   no-unused-vars\n   2:8   error  &#39;ReactDOM&#39; is defined but never used                no-unused-vars\n   3:20  error  &#39;Head&#39; is defined but never used                    no-unused-vars\n   3:26  error  &#39;Main&#39; is defined but never used                    no-unused-vars\n   3:32  error  &#39;NextScript&#39; is defined but never used              no-unused-vars\n   3:50  error  Strings must use doublequote                        quotes\n   4:30  error  Missing semicolon                                   semi\n   7:1   error  Expected indentation of 1 tab but found 2 spaces    indent\n   8:1   error  Expected indentation of 2 tabs but found 4 spaces   indent\n   9:1   error  Expected indentation of 3 tabs but found 6 spaces   indent\n  10:1   error  Expected indentation of 4 tabs but found 8 spaces   indent\n  11:1   error  Expected indentation of 4 tabs but found 8 spaces   indent\n  14:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  15:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  16:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  17:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  18:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  19:1   error  Expected indentation of 4 tabs but found 8 spaces   indent\n  21:1   error  Expected indentation of 4 tabs but found 8 spaces   indent\n  22:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  23:1   error  Expected indentation of 5 tabs but found 10 spaces  indent\n  25:1   error  Expected indentation of 4 tabs but found 8 spaces   indent\n  26:1   error  Expected indentation of 3 tabs but found 6 spaces   indent\n  27:1   error  Expected indentation of 2 tabs but found 4 spaces   indent\n  27:6   error  Missing semicolon                                   semi\n  28:1   error  Expected indentation of 1 tab but found 2 spaces    indent\n\n✖ 26 problems (26 errors, 0 warnings)\n  21 errors, 0 warnings potentially fixable with the `--fix` option.\n\n\n\n/home/ubuntu/workspace/pages/_error.js\n  6:16  error  Parsing error: Unexpected token getInitialProps\n\n✖ 1 problem (1 error, 0 warnings)\n\n\nYou may use special comments to disable some warnings.\nUse // eslint-disable-next-line to ignore the next line.\nUse /* eslint-disable */ to ignore all warnings in a file.\n&gt; Ready on http://localhost:8080</code></pre></div>\n<p>Yay!</p>\n<h2>Testing with Jest &#x26; Enzyme</h2>\n<h3>References</h3>\n<p>Again, helpful articles.</p>\n<ul>\n<li><a href=\"https://www.zerocho.com/category/React/post/583231469a87ec001834a0ec\">Zerocho</a></li>\n</ul>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://medium.com/of-all-things-tech-progress/starting-with-authentication-a-tutorial-with-node-js-and-mongodb-25d524ca0359\">medium post</a></li>\n<li><a href=\"https://medium.com/of-all-things-tech-progress/starting-with-authentication-a-tutorial-with-node-js-and-mongodb-25d524ca0359\">zerocho</a></li>\n<li><a href=\"http://webframeworks.kr/tutorials/expressjs/auth_log_in_out/\">webframeworks post</a></li>\n<li><a href=\"https://github.com/zeit/next.js/issues/153\">next.js discussion on login</a></li>\n</ul>\n<p>And I even found this: </p>\n<ul>\n<li>\n<p><a href=\"https://github.com/iaincollins/next-auth\">authentication library for nextjs</a>\n“connect-mongo”: “^2.0.1”,\n“dotenv”: “^5.0.1”,\n“express-session”: “^1.15.6”,\n“mongodb”: “^3.0.7”,\n“nedb”: “^1.8.0”,\n“next”: “^6.0.0”,\n“next-auth”: “^1.8.5”,\n“nodemailer”: “^4.6.4”,\n“nodemailer-direct-transport”: “^3.3.2”,\n“nodemailer-smtp-transport”: “^2.7.4”,\n“passport-facebook”: “^2.1.1”,\n“passport-google-oauth”: “^1.0.0”,\n“passport-twitter”: “^1.0.4”,</p>\n<h2>Install things</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install --save next-auth connect-mongo dotenv express-session mongodb nedb nodemailer nodemailer-direct-transport nodemailer-smtp-transport poassport-facebook passport-google-oauth passport-twitter</code></pre></div>\n</li>\n</ul>\n<h3>1. Create <code class=\"language-text\">index.js</code> and paste the following in</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// Include Next.js, Next Auth and a Next Auth config</span>\n<span class=\"token keyword\">const</span> next <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> nextAuth <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next-auth'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> nextAuthConfig <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./next-auth.config'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Load environment variables from .env</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dotenv'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Initialize Next.js</span>\n<span class=\"token keyword\">const</span> nextApp <span class=\"token operator\">=</span> <span class=\"token function\">next</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  dir<span class=\"token punctuation\">:</span> <span class=\"token string\">'.'</span><span class=\"token punctuation\">,</span>\n  dev<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">===</span> <span class=\"token string\">'development'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Add next-auth to next app</span>\nnextApp\n<span class=\"token punctuation\">.</span><span class=\"token function\">prepare</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Load configuration and return config object</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">nextAuthConfig</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>nextAuthOptions <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Pass Next.js App instance and NextAuth options to NextAuth</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">nextAuth</span><span class=\"token punctuation\">(</span>nextApp<span class=\"token punctuation\">,</span> nextAuthOptions<span class=\"token punctuation\">)</span>  \n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// port 8080 for c9.io</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token string\">`Ready on http://localhost:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">PORT</span> <span class=\"token operator\">||</span> <span class=\"token number\">8080</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">.</span><span class=\"token keyword\">catch</span><span class=\"token punctuation\">(</span>err <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'An error occurred, unable to start the server'</span><span class=\"token punctuation\">)</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>2. edit <code class=\"language-text\">package.json</code> like this</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token string\">\"scripts\"</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"dev\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"NODE_ENV=development node index.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"build\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"next build\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"start\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"next start\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<h3>3. Create new files</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">j031:~/workspace (add2-adminPage) $ tree . -L 3 -I node_modules                                \n.\n├── README.md\n├── components\n│   ├── article.js\n│   ├── copyright.js\n│   ├── fixedHeading\n│   │   ├── fakeButton.js\n│   │   ├── fixedHeadingLayout.js\n│   │   ├── menuButton.js\n│   │   └── title.js\n│   ├── footer.js\n│   ├── header.js\n│   ├── layout.js\n│   ├── mainContent\n│   │   ├── mainContent.js\n│   │   └── mainContentLayout.js\n│   ├── misc\n│   │   └── sidebar.js\n│   └── slideMenu.js\n├── index.js\n├── next-auth-config.js ---------------------&gt; This\n├── next-auth.functions.js ---------------------&gt; This\n├── next-auth.providers.js ---------------------&gt; This\n├── next.config.js\n├── note\n├── package.json --------------------&gt; this (only npm run dev)\n├── pages\n│   ├── _document.js\n│   ├── _error.js\n│   ├── auth ---------------------&gt; This\n│   │   ├── callback.js ---------------------&gt; This\n│   │   ├── check-email.js ---------------------&gt; This\n│   │   ├── error.js ---------------------&gt; This\n│   │   └── index.js ---------------------&gt; This\n│   ├── cyadmin.js\n│   └── index.js\n└── styles\n    ├── font.sass\n    ├── grommet-button-fix.scss\n    ├── grommet-dxc.min.scss\n    ├── grommet-heading-fix.sass\n    ├── master.sass\n    ├── menu-button-responsive-fix.sass\n    └── react-burger-menu-custom-style.scss\n\n7 directories, 36 files</code></pre></div>\n<h3>4. Just copy the contents of the files from the repository into the corresponding files newly created.</h3>\n<h3>5. Write <code class=\"language-text\">.eslintignore</code> at your root directory</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">next-auth*\n/home/ubuntu/workspace/index.js\n/home/ubuntu/workspace/pages/_error.js\nauth</code></pre></div>\n<p>you do this because <code class=\"language-text\">next build</code> will crash because of the chained output from eslint. For some reason, it will crash if there is any output from eslint. As a temporary tweak, just disable eslint or prevent output from eslint during build.</p>\n<h3>6. Install <code class=\"language-text\">mongodb-org</code> just for c9…</h3>\n<p>Yeah. It cannot support <code class=\"language-text\">mongod</code> for some reason. So do:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo apt-get install -y mongodb-org</code></pre></div>\n<p>And follow additional steps here:\n<a href=\"https://community.c9.io/t/setting-up-mongodb/1717\">C9’s explanation on how to run mongodb on c9.io</a></p>\n<h3>7. Run <code class=\"language-text\">mongod</code></h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">./mongod --httpinterface\n\nthis is equivalent to:\n\nmongod --bind_ip=$IP --dbpath=data --nojournal --rest --httpinterface &quot;$@&quot;\n\nbecause in the step 6, you do:\n\nmongod --bind_ip=$IP --dbpath=data --nojournal --rest &quot;$@&quot; &gt; mongod \n\nfor c9&#39;s specific environment.  </code></pre></div>\n<h3>8. Launch up with <code class=\"language-text\">node index.js</code> from your root directory (I found that <code class=\"language-text\">NODE_ENV=development node index.js</code> does not work for some reason)</h3>\n<h3>9. Browse <code class=\"language-text\">/auth</code></h3>\n<p>Now you can see the <code class=\"language-text\">auth</code> page!\nThe only thing you have to do now is to customize. </p>\n<p><img src=\"https://i.imgur.com/x08iynD.jpg\" alt=\"Browse /auth\"></p>\n<h3>10. Add oAuth</h3>","frontmatter":{"title":"Yet another blog in nextjs","date":"June 04, 2018"}}},"pageContext":{"slug":"/2018-06-04--Yet-another-blog-in-nextjs/","previous":{"fields":{"slug":"/2018-06-01--Next.js-(1):-Basic-setup-and-understanding/"},"frontmatter":{"title":"Next.js (1): Basic setup and understanding"}},"next":{"fields":{"slug":"/2018-06-05--Creating-music-player/"},"frontmatter":{"title":"Creating music player"}}}}