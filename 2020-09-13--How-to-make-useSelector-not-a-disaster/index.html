<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:#007acc;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}</style><style data-href="/styles.9f2e20345ed17da42ed8.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-191cc9f50f3b76b9617cb383f19acb7d.woff2) format("woff2"),url(/static/montserrat-latin-100-370318464551d5f25b0f0a78f374faac.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-bdeaeb79db315697bd173a55b097dc18.woff2) format("woff2"),url(/static/montserrat-latin-100italic-ecf7d49386e8f265878e735db34a7c4b.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-85d5ef9db7f2dc6979172a4a3b2c57cb.woff2) format("woff2"),url(/static/montserrat-latin-200-1fc98e126a3d152549240e6244d7e669.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-49095760a498d024fe1a85a078850df9.woff2) format("woff2"),url(/static/montserrat-latin-200italic-fe46cf8b9462c820457d3bf537e4057f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-7c3daf12b706645b5d3710f863a4da04.woff2) format("woff2"),url(/static/montserrat-latin-300-8dc95fab9cf98d02ca8d76e97d3dff60.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-f20b178ca2024a5eac8e42e6649db86c.woff2) format("woff2"),url(/static/montserrat-latin-300italic-3fe16939288856e8e828fa2661bf2354.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-bc3aa95dca08f5fee5291e34959c27bc.woff2) format("woff2"),url(/static/montserrat-latin-400-8102c4838f9e3d08dad644290a9cb701.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-5cad650422a7184467af5a4d17b264c4.woff2) format("woff2"),url(/static/montserrat-latin-400italic-d191f22af3bb50902b99ac577f81a322.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-92d16e458625f4d2c8940f6bdca0ff09.woff2) format("woff2"),url(/static/montserrat-latin-500-8b763220218ffc11c57c84ddb80e7b26.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-47bfcca6b69d6a9acca7a8bff17193e2.woff2) format("woff2"),url(/static/montserrat-latin-500italic-72c01f753c3940c0b9cb6bf2389caddf.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-6fb1b5623e528e27c18658fecf5ee0ee.woff2) format("woff2"),url(/static/montserrat-latin-600-7c839d15a6f54e7025ba8c0c4b333e8f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-60789af1c9338ed1a9546722ec54b4f7.woff2) format("woff2"),url(/static/montserrat-latin-600italic-f3d4de8d0afb19e777c79032ce828e3d.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-39d93cf678c740f9f6b2b1cfde34bee3.woff2) format("woff2"),url(/static/montserrat-latin-700-80f10bd382f0df1cd650fec59f3c9394.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-ba136d97b14e82284dd595e257f11c47.woff2) format("woff2"),url(/static/montserrat-latin-700italic-8c98142b425630821139c24bd1698700.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-b7018be9ed6cd94da8b6675b3a468c3b.woff2) format("woff2"),url(/static/montserrat-latin-800-9a9befcf50d64f9d2d19d8b1d1984add.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-540ffdd223d1a9ad3d4e678e1a23372e.woff2) format("woff2"),url(/static/montserrat-latin-800italic-897086f99f4e1f45e6b1e9368527d0bc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-58cd789700850375b834e8b6776002eb.woff2) format("woff2"),url(/static/montserrat-latin-900-26d42c9428780e545a540bbb50c84bce.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-451157bc8861fe54f523b3669a3def71.woff2) format("woff2"),url(/static/montserrat-latin-900italic-a8ec4957e1c24f5793305763ad9845b3.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}pre[class*=language-].line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}pre[class*=language-].line-numbers>code{position:relative;white-space:inherit}.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:0;font-size:100%;left:-3.8em;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-ms-user-select:none;user-select:none}.line-numbers-rows>span{display:block;counter-increment:linenumber}.line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}pre code{white-space:pre-wrap!important;white-space:-moz-pre-wrap!important;white-space:-pre-wrap!important;white-space:-o-pre-wrap!important;word-wrap:break-word!important}</style><meta name="generator" content="Gatsby 2.24.53"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#009688"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png"/><title data-react-helmet="true">How to make useSelector not a disaster | Joel&#x27;s dev blog</title><meta data-react-helmet="true" name="description" content="Disclaimer: We will focus on  itself in this article, rather than third-party libraries like , because it’s out of scope of the article.  How was it like before…"/><meta data-react-helmet="true" property="og:title" content="How to make useSelector not a disaster"/><meta data-react-helmet="true" property="og:description" content="Disclaimer: We will focus on  itself in this article, rather than third-party libraries like , because it’s out of scope of the article.  How was it like before…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Joel Mun"/><meta data-react-helmet="true" name="twitter:title" content="How to make useSelector not a disaster"/><meta data-react-helmet="true" name="twitter:description" content="Disclaimer: We will focus on  itself in this article, rather than third-party libraries like , because it’s out of scope of the article.  How was it like before…"/><link as="script" rel="preload" href="/webpack-runtime-97553801e29f959bea1c.js"/><link as="script" rel="preload" href="/framework-b5b229d58c3c710d5429.js"/><link as="script" rel="preload" href="/app-06ff2ede40703d30e0fb.js"/><link as="script" rel="preload" href="/styles-2d82ac8e3afc0c213061.js"/><link as="script" rel="preload" href="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-8c2c0a496a06ce672a0f.js"/><link as="script" rel="preload" href="/cd7d5f864fc9e15ed8adef086269b0aeff617554-0a267a894a1ce68c02dc.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-28fb13911c773217cda0.js"/><link as="fetch" rel="preload" href="/page-data/2020-09-13--How-to-make-useSelector-not-a-disaster/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3128451518.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/426816048.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:70rem;padding:2.625rem 1.3125rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Joel&#x27;s dev blog</a></h3></header><main><h1>How to make useSelector not a disaster</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.75rem">September 13, 2020</p><div><p><em>Disclaimer</em>: We will focus on <code class="language-text">useSelector</code> itself in this article, rather than third-party libraries like <code class="language-text">reselect</code>, because it’s out of scope of the article. </p>
<h1>How was it like before?</h1>
<p>Now, before talking about <code class="language-text">useSelector</code>, we need to know some background. Let’s go back to pre-function component era, where all we needed to care about were the <code class="language-text">props</code>. Not so much you needed to do. Choices were <code class="language-text">PureComponent</code> and <code class="language-text">shouldComponentUpdate</code>. Nothing else. Like this:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> shouldShowRed<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SomeDiv</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>PureComponent<span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
        background<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>shouldShowRed <span class="token operator">?</span> <span class="token string">'red'</span> <span class="token operator">:</span> <span class="token string">'white'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
      hi
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> SomeDiv<span class="token punctuation">;</span></code></pre></div>
<p>Right. So if you make such component, this component is only going to update when <code class="language-text">shouldShowRed</code> is changed. Otherwise, it is going to stay still even if its parent renders for some reason. It goes the same for <code class="language-text">shouldComponentUpdate</code>; It just gives you additional tooling to specify your own method of telling the component when to update.</p>
<h1>Using it with redux?</h1>
<p>Again, using the component with redux was pretty straightforward too. Just create a container and pass states and dispatches (I didn’t write any <code class="language-text">mapDispatchToProps</code> for the sake of simplicity) mapped as props: </p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// Presentational component (same as the above component)</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">interface</span> <span class="token class-name">Props</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> shouldShowRed<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SomeDiv</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>PureComponent<span class="token operator">&lt;</span>Props<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token operator">></span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
        background<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>shouldShowRed <span class="token operator">?</span> <span class="token string">'red'</span> <span class="token operator">:</span> <span class="token string">'white'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>
      hi
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> SomeDiv<span class="token punctuation">;</span>

<span class="token comment">// container component</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Dispatch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> SomeDiv <span class="token keyword">from</span> <span class="token string">'./SomeDiv'</span><span class="token punctuation">;</span>

<span class="token comment">// Let's say that we have this redux root state</span>
<span class="token keyword">interface</span> <span class="token class-name">RootReduxState</span> <span class="token punctuation">{</span>
    <span class="token keyword">readonly</span> conditions<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">readonly</span> shouldShowRed<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
        <span class="token keyword">readonly</span> shouldShowGreen<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
        <span class="token keyword">readonly</span> shouldShowBlue<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span><span class="token operator">:</span> <span class="token punctuation">(</span>
  state<span class="token operator">:</span> RootReduxState<span class="token punctuation">;</span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span> <span class="token keyword">readonly</span> shouldShowRed<span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'shouldShowRed'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">(</span>
  state<span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  shouldShowRed<span class="token operator">:</span> state<span class="token punctuation">.</span>shouldShowRed<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">(</span>SomeDiv<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Right. Let’s assume that we have <code class="language-text">RootReduxState</code> as we have seen from the code above. And this is just going to work so well. Nothing difficult here. <code class="language-text">SomeDiv</code> will keep being efficient at its best because <code class="language-text">PureComponent</code> is working well. But how should we precisely port this example to a function component?</p>
<h1>Function component</h1>
<p>Well, it’s easy. Just use <code class="language-text">useSelector</code>, Right?</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">const</span> SomeDiv<span class="token operator">:</span> <span class="token function-variable function">FC</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> shouldShowRed<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>shouldShowRed<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
        width<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token string">'300px'</span><span class="token punctuation">,</span>
        background<span class="token operator">:</span> shouldShowRed <span class="token operator">?</span> <span class="token string">'red'</span> <span class="token operator">:</span> <span class="token string">'white'</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span> 

<span class="token keyword">export</span> <span class="token keyword">default</span> SomeDiv<span class="token punctuation">;</span></code></pre></div>
<p>Perfect. But what if you need more than just  <code class="language-text">shouldShowRed</code>? The moment you start to get more than one thing from useSelector (which is a very normal case), you are going to need additional optimization efforts with appropriate knowledge.</p>
<p>If we were to use <code class="language-text">shouldShowGreen</code> too, we could choose:</p>
<p><strong>Option 1</strong></p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span>
  shouldShowRed<span class="token punctuation">,</span>
  shouldShowGreen<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> conditions<span class="token operator">:</span> <span class="token punctuation">{</span> shouldShowRed<span class="token punctuation">,</span> shouldShowGreen <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  shouldShowRed<span class="token punctuation">,</span> shouldShowGreen
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>Or, we could:</p>
<p><strong>Option 2</strong></p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span>
    conditions<span class="token operator">:</span> <span class="token punctuation">{</span>
        shouldShowRed<span class="token punctuation">,</span>
        shouldShowGreen<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">;</span></code></pre></div>
<p>Alternatively:</p>
<p><strong>Option 3</strong></p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> shouldShowRed<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>shouldShowRed<span class="token punctuation">)</span>
<span class="token keyword">const</span> shouldShowGreen<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>shouldShowGreen<span class="token punctuation">)</span></code></pre></div>
<p>Or, just a small variant..</p>
<p><strong>Option 4</strong></p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span> shouldShowRed<span class="token punctuation">,</span> shouldShowGreen <span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">)</span></code></pre></div>
<h1>useSelector</h1>
<p>Which method have you been using? Whichever one you are using, you should be able to give reasons! Now, before having a look at each option, let’s go back to <code class="language-text">useSelector</code> and see what it does.</p>
<p>So let me bring the most important thing to the table immediately: <code class="language-text">useSelector</code> forces re-render of your component. It’s not a prop, but it can still make your component re-render. Really? Yes. Let’s look at <a href="https://react-redux.js.org/api/hooks#useselector">the offical documentation</a>:</p>
<blockquote>
<p>When an action is dispatched, useSelector() will do a reference comparison of the previous selector result value and the current result value. <strong>If they are different, the component will be forced to re-render</strong>. If they are the same, the component will not re-render.</p>
</blockquote>
<p>So how do you judge if they are different? By running strict equality (<code class="language-text">===</code>) comparision. (<a href="https://github.com/reduxjs/react-redux/blob/master/src/hooks/useSelector.js#L98">Click here if you are feeling like looking at the official repo’s source code</a>). In the source code, <code class="language-text">useSelector</code> by default uses a function called <code class="language-text">refEquality</code>, and all it does is simply <a href="https://github.com/reduxjs/react-redux/blob/master/src/hooks/useSelector.js#L7"><code class="language-text">const refEquality = (a, b) =&gt; a === b</code></a>.</p>
<p>This means that if you are returning an object from <code class="language-text">useSelector</code> for whatever reason, <code class="language-text">useSelector</code> will cause a re-render every time an action is dispatched from the store, simply because objects of the same structure (same keys and values) do not strictly equal each other in javascript. For example, <code class="language-text">{ a: 1 } === { a: 1 }</code> is <code class="language-text">false</code>. Official doc says the same:</p>
<blockquote>
<p>returning a new object every time will always <strong>force a re-render</strong> by default.</p>
</blockquote>
<p>Do they really force it? Yes. <a href="https://github.com/reduxjs/react-redux/blob/master/src/hooks/useSelector.js#L73">From the source code</a>:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> forceRender<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>s <span class="token operator">=></span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> 

<span class="token operator">...</span>

<span class="token function">forceRender</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div>
<p>So… now, with this in our mind, let’s go back to the options we saw previously.</p>
<h1>Which one to pick</h1>
<h2>Option 1</h2>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span>
  shouldShowRed<span class="token punctuation">,</span>
  shouldShowGreen<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span> conditions<span class="token operator">:</span> <span class="token punctuation">{</span> shouldShowRed<span class="token punctuation">,</span> shouldShowGreen <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  shouldShowRed<span class="token punctuation">,</span> shouldShowGreen
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><em>Catches</em>:</p>
<ol>
<li>You are just writing a pair of <code class="language-text">shouldShowRed</code> and <code class="language-text">shouldShowGreen</code> for three times just to take the desired state out.</li>
<li>This will cause a re-render forcefully every time an action is dispatched, because you are returning a new object from your selector.</li>
</ol>
<p><em>Verdict</em>: not good enough.</p>
<h2>Option 2</h2>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span>
    conditions<span class="token operator">:</span> <span class="token punctuation">{</span>
        shouldShowRed<span class="token punctuation">,</span>
        shouldShowGreen<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><em>Catches</em>: you are returning the entire state from your selector, and destructuring it outside of the selector. This will too cause a re-render. What’s the point of having the selector callback if you intend to receive the entire state? This is a bad practice. It’s just tantamount to passing the entire state in <code class="language-text">mapStateToProps</code>. You don’t do that there. So, why here?</p>
<p><em>Verdict</em>: not good enough.</p>
<h2>Option 3</h2>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> shouldShowRed<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>shouldShowRed<span class="token punctuation">)</span>
<span class="token keyword">const</span> shouldShowGreen<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">.</span>shouldShowGreen<span class="token punctuation">)</span></code></pre></div>
<p><em>Catches</em>: </p>
<ol>
<li>
<p>you are calling <code class="language-text">useSelector</code> twice, and this does not matter. According to the official doc:</p>
<blockquote>
<p>Because of the React update batching behavior used in React Redux v7, a dispatched action that causes multiple useSelector()s in the same component to return new values <strong>should only result in a single re-render</strong>.</p>
</blockquote>
</li>
<li>strict equality is functioning as properly for each selected state because you are returning a primitive from each selector.</li>
</ol>
<p><em>Verdict</em>: usable.</p>
<h2>Option 4:</h2>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span> shouldShowRed<span class="token punctuation">,</span> shouldShowGreen <span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">)</span></code></pre></div>
<p><em>Catches</em>: It’s just the same as option 1 or 2. It will cause a re-render too.</p>
<p><em>Verdict</em>: Not good enough.</p>
<h1>Improving the bad options</h1>
<p>Thankfully, redux gives us a chance to insert our own equality functions. The concept is the same <code class="language-text">shouldComponentUpdate</code> or the equality callback in <code class="language-text">React.memo</code>. We could do this:</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> <span class="token punctuation">{</span> shouldShowRed<span class="token punctuation">,</span> shouldShowGreen <span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span> <span class="token operator">=</span>
  <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">,</span> <span class="token punctuation">(</span>prev<span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=></span> prev<span class="token punctuation">.</span>shouldShowRed <span class="token operator">===</span> next<span class="token punctuation">.</span>shouldShowRed <span class="token operator">&amp;&amp;</span> prev<span class="token punctuation">.</span>shouldShowGreen <span class="token operator">===</span> next<span class="token punctuation">.</span>shouldShowGreen<span class="token punctuation">)</span></code></pre></div>
<p>or,</p>
<div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> deepEqual <span class="token keyword">from</span> <span class="token string">'react-fast-compare'</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> shouldShowRed<span class="token punctuation">,</span> shouldShowGreen <span class="token punctuation">}</span><span class="token operator">:</span> RootReduxState<span class="token punctuation">[</span><span class="token string">'conditions'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSelector</span><span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> RootReduxState<span class="token punctuation">)</span> <span class="token operator">=></span> s<span class="token punctuation">.</span>conditions<span class="token punctuation">,</span> deepEqual<span class="token punctuation">)</span></code></pre></div>
<p>Something like that. However you should really note that using <code class="language-text">deepEqual</code> cannot ever be fast if you are trying to equal a large object (<a href="https://twitter.com/dan_abramov/status/1104414272753487872?s=20">Dan Abramov said it, too!</a>):</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/ffb5ac84c8114e90fff8d77440a24e5c/77800/dan.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 166.89189189189187%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAhCAYAAADZPosTAAAACXBIWXMAAAsSAAALEgHS3X78AAAFrklEQVRIx31WW28bVRBeIV6aNnHiOInv3ovv68vaju347sSxnXuaBlFVCFU8AEJFCIT6ABKFIkA8IgSCJxBv9AcU9d99zDe2kxKVPozP7DneOd/MfDOzxujoAh9+/BlSxbpK1tuBmatgNWRjLey8Um6eLZ7Xo0kYXz39Hs+f/4Ph5ATbrR46gxG8ehtrIQurQVNXleBc/ueShRiJTBles4+NWAprVhGrZhF+28OqVVbdF3exmnDhSxRUVoI2ljcTM9kyZTWxIusCqeG4VeQrTWTLDTi1IazKALFyD7boZqUP0+shXmrD8rp6HkmVQBCJrIdIsqB6xJGLtmbojWK9i+npJbp7h9g/PMNYpLd3gN3JMbq7UwzHxxgfnWN3eqJ7vdERJif3VIbTU3RHh9g7OEc8XYJPQmLkqy09qHdH2O7soS8GBhLPUr2HncFEzs505Xm1vYuW6Hyn1OihsjNAodZBo7ePsoRNDWbKTYyPL9DePdDbaHA4OUWzP0ZH9ian9xQ9daLjZbFUEZuJrErYcbFlZq/iaPAmwu/vHwuSsRieKore/hFqgoio+UwERMmVe0RHIQjuBySpmhQi5ItE5Lg1zR4DzBspy3NZuZLrM7q40BdcNIJmBnZOspYuwsyWVOdqZkpIuhUVJ+9dIXgd2RXhViKDsJ0DDatu5XTlc1BiExVqcKVBVkIgmhJJvlK0UkzhU65cR1JQBK0s0sWaoky6nhhzJdudK4T+SBJ+lpisL4s/4sxXMeifb4YE2WY8PavJ+YshKzs3dG2E3qxH58YjM1T0aGHYuLMRx9J6VF25NuiowbAY5J4/bOseRS+Jzi6kQZZs1MmrMUX43geP8NPPv6A1nEimR8K1Q3jtPek827Al60lZoxlPdTNfg1PYRiCRgy+S1iQsb1rCAkcv2ZDLjUefPsYff/4lbB+h3h6g3Ogi1zlEViTdOkCqsQ93eI7UzhSZzhGs2p7uUU+4TZQqRbjFNO5skgGSZfJqNeRIgbtIl+pSBSVYkig7X5GGUZcEkTpVbQKpQk11J18VapURz1RQrVeRK2QUpfIwEEsjmi6rdcaAJL0tcSXBGSd9DsRE4qrTtTsbCdxaj+n+StDBrcA1uY3HXzzB38+eSc1eSkc5xcHZW9I9zrAt7ldbfXiNjra2SrOH6k5fpCcoa9pdiJo8tXKe6hsCzrh88BBff/sDvHltaiylNtlBWI6sb9YydTYQNoeOtDfuL85Y27xAs7wk0N9Y3tI2RHQcBZRdaVujw3P9My9hVy83+lr3i/ZVbQ31nN2H9NMYkqSBeEahM+g8pNAFJoYNgDFjTBln5WroegzcHFqzSpkb9UeFW5EUfOGkGiKveLb4M6uGdc2qIDO4xyrxv9wcCPXWWhhrMogC2SYCuRbWU7XZ1BNhlczEuVpZMYHIjMw0/p/mcHH/XXz55KlkU1q+xGq7NdBWbwvXkhKCuLhuic5nDqY18YCe+GPpubvW3GVbPTA++uRz/P7br2h095QqtfZQquQI8aoYbYwR8/qI1UaIlPuIyxoqdBHMtxAsDbEhYzds5xGyXQlPZuYyCbkkBHVrbZ0lOlek/XPOkB7kJp+Z8cGCATLlTu+e4/LeSLxoICdfG0yiDin+3JYsRqRjsPyYBN4WkpsTwi0OoqApTVeE5+QbdbaxqJ1UN2nDN/+qMGzpIPXuvk6usEDnyyxHBl6/JiQ2s7KyNOikDelCr5YCs/KkMe6py9989yNevHiBo4v7Ov3uvv0OpiccnVOJ6VDG5wRtaW1cm5I0xpokJ7ldkcVHllttK5eN1vAADx6+r5sckRzwRRFWBMuRFUEDXnOglcFy4xmrJysTk56FrLx6x3AZhP6mLyQETSMkg2nx1cXDWKqg64K0mxJbxpHdeW3uKonNs6tu44+ktP37zQICaenG6boQuypGrStDr5Ob4/RfAjrZQx8+IzMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="dan"
        title="dan"
        src="/static/ffb5ac84c8114e90fff8d77440a24e5c/fcda8/dan.png"
        srcset="/static/ffb5ac84c8114e90fff8d77440a24e5c/12f09/dan.png 148w,
/static/ffb5ac84c8114e90fff8d77440a24e5c/e4a3f/dan.png 295w,
/static/ffb5ac84c8114e90fff8d77440a24e5c/fcda8/dan.png 590w,
/static/ffb5ac84c8114e90fff8d77440a24e5c/77800/dan.png 855w"
        sizes="(max-width: 590px) 100vw, 590px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>Note also that you only want to run <code class="language-text">deepEqual</code> on what you need. In the code snippet above, you are also comparing <code class="language-text">shouldShowBlue</code> which is a part of <code class="language-text">RootReduxState[&#39;conditions&#39;]</code>. But you don’t need that anyways, but you are still comparing it. Make sure you <em>select</em> and <em>compare</em> what you only need.</p>
<h1>But why would you try optimizing it in the first place?</h1>
<p>Well, at first, it’s totally okay. Your app has ~100 components only, your redux state is quite shallow, and it does not take a long time to render whatever’s being rendered.</p>
<p>The problem comes at two points:</p>
<ol>
<li><em>once you start to scale your application.</em> If you succeeed in making a popular application, you are going to support more features, and thus, need more components. Your components will be numerous, leading to the point where re-render of expensive components will be causing a sluggish interaction.</li>
<li><em>once you start to care about users using low-end devices.</em> You want to support users with low-end spec computers. You want to support mobile devies with inherently less performance than most computers. Just get a 6x slowdown on your CPU from Chrome’s performance tool and try to see how long it takes for your components to react.</li>
</ol>
<h1>Conclusion</h1>
<p>So far we looked at possible problems with using <code class="language-text">useSelector</code> and how to solve them:</p>
<ol>
<li>If you are returning an object from your selector callback, it’s going to force re-render by default.</li>
<li>To prevent re-render, either let your selector return a primitive type, or use a custom equality function.</li>
</ol>
<p>That’s it. Thank you!</p></div><hr style="margin-bottom:1.75rem"/><div style="display:flex"><div class=" gatsby-image-wrapper" style="position:relative;overflow:hidden;display:inline-block;width:50px;height:50px;margin-right:0.875rem;margin-bottom:0;min-width:50px;border-radius:100%"><img aria-hidden="true" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAQDAf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAABy7nSMycNUI5yDf/EABoQAQEAAwEBAAAAAAAAAAAAAAECAAMSBBH/2gAIAQEAAQUCKcJEdM/YiqC5hvZ3XqtNnSDn/8QAFhEAAwAAAAAAAAAAAAAAAAAAABAR/9oACAEDAQE/ASv/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQIBAT8BI//EACAQAAIBAwQDAAAAAAAAAAAAAAABAhExQRASISJRUmH/2gAIAQEABj8CpQcZXOz2vwVdj57DkxwXEY4Glm+n/8QAGxAAAgMBAQEAAAAAAAAAAAAAAAERITFBYYH/2gAIAQEAAT8hgUw8H+KVqHQvZJwmVzhuN3ufBm5YyHgQkhCf6Gg//9oADAMBAAIAAwAAABAQKHz/xAAYEQACAwAAAAAAAAAAAAAAAAAAARARUf/aAAgBAwEBPxBIrk//xAAZEQADAAMAAAAAAAAAAAAAAAAAAREQIVH/2gAIAQIBAT8Qbmi+ix//xAAdEAEAAgIDAQEAAAAAAAAAAAABABEhMUFRYXHB/9oACAEBAAE/EG07OyWDzfUTIQvQcUBt9YkDm7GPYqTeWIPe/wBmi62AQwsVa+YlES9/DggPKdTCvL2xUW0HqIqGsT//2Q==" alt="Joel Mun" style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover;object-position:center;opacity:1;transition-delay:500ms;border-radius:50%"/><noscript><picture><source srcset="/static/1265356b9e6bab3ff8ccafeaca6d96b8/99438/profile-pic.jpg 1x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/aba1d/profile-pic.jpg 1.5x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/b315d/profile-pic.jpg 2x" /><img loading="lazy" width="50" height="50" srcset="/static/1265356b9e6bab3ff8ccafeaca6d96b8/99438/profile-pic.jpg 1x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/aba1d/profile-pic.jpg 1.5x,
/static/1265356b9e6bab3ff8ccafeaca6d96b8/b315d/profile-pic.jpg 2x" src="/static/1265356b9e6bab3ff8ccafeaca6d96b8/99438/profile-pic.jpg" alt="Joel Mun" style="position:absolute;top:0;left:0;opacity:1;width:100%;height:100%;object-fit:cover;object-position:center"/></picture></noscript></div><p>Written by <strong>Joel Mun</strong>. Joel&#x27;s been interested in Javascript, Typescript, Assemblyscript, Rust, Dart, and React, Flutter, and more.<!-- --> <a href="https://github.com/9oelM">Go check him up on Github!</a><br/> <!-- -->Joel&#x27;s also got his own random thoughts journal (mostly in Korean).<!-- --> <a href="https://www.notion.so/9oelm/2acfc525c9964be080d218770e6b8431?v=a7970392a2c54d3b857db145ded4de9e">Check it out too if you are curious.</a></p></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/2020-08-18--100BooksProject-(7):돈의-속성-(Properties-of-money)/">← <!-- -->100BooksProject: (7): 돈의 속성 (Properties of money)</a></li><li></li></ul><div id="disqus_thread" identifier="c66c32c7-d569-5728-9603-253f9b08ad21" title="How to make useSelector not a disaster" url="https://9oelm.github.io/2020-09-13--How-to-make-useSelector-not-a-disaster/"></div></main><footer>© Joel Mun <!-- -->2020<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-105275697-3', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2020-09-13--How-to-make-useSelector-not-a-disaster/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-905013744daa67b74738.js"],"app":["/app-06ff2ede40703d30e0fb.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-e5cb9e0c77a823b86dc2.js"],"component---src-pages-404-js":["/component---src-pages-404-js-0559109825d05de6d257.js"],"component---src-pages-index-js":["/component---src-pages-index-js-e2f445bd6d7979186701.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-28fb13911c773217cda0.js"]};/*]]>*/</script><script src="/polyfill-905013744daa67b74738.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-28fb13911c773217cda0.js" async=""></script><script src="/cd7d5f864fc9e15ed8adef086269b0aeff617554-0a267a894a1ce68c02dc.js" async=""></script><script src="/d5d7a013bc6c1e2b6d7db819052c16d7efea5559-8c2c0a496a06ce672a0f.js" async=""></script><script src="/styles-2d82ac8e3afc0c213061.js" async=""></script><script src="/app-06ff2ede40703d30e0fb.js" async=""></script><script src="/framework-b5b229d58c3c710d5429.js" async=""></script><script src="/webpack-runtime-97553801e29f959bea1c.js" async=""></script></body></html>